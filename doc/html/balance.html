<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>balance command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/balance.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bond_coeff command" href="bond_coeff.html" />
    <link rel="prev" title="atom_style command" href="atom_style.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="commands_list.html">Commands</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="angle_coeff.html">angle_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="angle_style.html">angle_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="angle_write.html">angle_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="atom_modify.html">atom_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="atom_style.html">atom_style command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">balance command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bond_coeff.html">bond_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_style.html">bond_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_write.html">bond_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary.html">boundary command</a></li>
<li class="toctree-l2"><a class="reference internal" href="change_box.html">change_box command</a></li>
<li class="toctree-l2"><a class="reference internal" href="clear.html">clear command</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm_modify.html">comm_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm_style.html">comm_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute.html">compute command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_modify.html">compute_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_atoms.html">create_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_bonds.html">create_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_box.html">create_box command</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete_atoms.html">delete_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete_bonds.html">delete_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dielectric.html">dielectric command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_coeff.html">dihedral_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_style.html">dihedral_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_write.html">dihedral_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dimension.html">dimension command</a></li>
<li class="toctree-l2"><a class="reference internal" href="displace_atoms.html">displace_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html">dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-vtk-command"><span class="xref std std-doc">dump vtk</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-h5md-command"><span class="xref std std-doc">dump h5md</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-molfile-command"><span class="xref std std-doc">dump molfile</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-netcdf-command"><span class="xref std std-doc">dump netcdf</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-image-command"><span class="xref std std-doc">dump image</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-movie-command"><span class="xref std std-doc">dump movie</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-atom-adios-command"><span class="xref std std-doc">dump atom/adios</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-custom-adios-command"><span class="xref std std-doc">dump custom/adios</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-cfg-uef-command"><span class="xref std std-doc">dump cfg/uef</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_adios.html">dump atom/adios  command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_adios.html#dump-custom-adios-command">dump custom/adios command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_cfg_uef.html">dump cfg/uef command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_h5md.html">dump h5md command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_image.html">dump image command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_image.html#dump-movie-command">dump movie command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_image.html#dump-modify-options-for-dump-image-movie">dump_modify options for dump image/movie</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_modify.html">dump_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_modify.html#dump-modify-command-for-image-movie-options"><span class="xref std std-doc">dump_modify</span> command for image/movie options</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_molfile.html">dump molfile command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_netcdf.html">dump netcdf command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_netcdf.html#dump-netcdf-mpiio-command">dump netcdf/mpiio command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_vtk.html">dump vtk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamical_matrix.html">dynamical_matrix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="echo.html">echo command</a></li>
<li class="toctree-l2"><a class="reference internal" href="fix.html">fix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="fix_modify.html">fix_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitpod_command.html">fitpod command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group.html">group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group2ndx.html">group2ndx command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group2ndx.html#ndx2group-command">ndx2group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyper.html">hyper command</a></li>
<li class="toctree-l2"><a class="reference internal" href="if.html">if command</a></li>
<li class="toctree-l2"><a class="reference internal" href="improper_coeff.html">improper_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="improper_style.html">improper_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="include.html">include command</a></li>
<li class="toctree-l2"><a class="reference internal" href="info.html">info command</a></li>
<li class="toctree-l2"><a class="reference internal" href="jump.html">jump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html">kim command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kspace_modify.html">kspace_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kspace_style.html">kspace_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="label.html">label command</a></li>
<li class="toctree-l2"><a class="reference internal" href="labelmap.html">labelmap command</a></li>
<li class="toctree-l2"><a class="reference internal" href="lattice.html">lattice command</a></li>
<li class="toctree-l2"><a class="reference internal" href="log.html">log command</a></li>
<li class="toctree-l2"><a class="reference internal" href="mass.html">mass command</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdi.html">mdi command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_modify.html">min_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html">min_style spin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html#min-style-spin-cg-command">min_style spin/cg command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html#min-style-spin-lbfgs-command">min_style spin/lbfgs command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html">min_style cg command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-hftn-command">min_style hftn command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-sd-command">min_style sd command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-quickmin-command">min_style quickmin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-fire-command">min_style fire command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-spin-command"><span class="xref std std-doc">min_style spin</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-spin-cg-command"><span class="xref std std-doc">min_style spin/cg</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html#min-style-spin-lbfgs-command"><span class="xref std std-doc">min_style spin/lbfgs</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="minimize.html">minimize command</a></li>
<li class="toctree-l2"><a class="reference internal" href="minimize.html#minimize-kk-command">minimize/kk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="molecule.html">molecule command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neb.html">neb command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neb_spin.html">neb/spin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neigh_modify.html">neigh_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbor.html">neighbor command</a></li>
<li class="toctree-l2"><a class="reference internal" href="newton.html">newton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="next.html">next command</a></li>
<li class="toctree-l2"><a class="reference internal" href="package.html">package command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_coeff.html">pair_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_modify.html">pair_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_style.html">pair_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_write.html">pair_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="partition.html">partition command</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin.html">plugin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="prd.html">prd command</a></li>
<li class="toctree-l2"><a class="reference internal" href="print.html">print command</a></li>
<li class="toctree-l2"><a class="reference internal" href="processors.html">processors command</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">python command</a></li>
<li class="toctree-l2"><a class="reference internal" href="quit.html">quit command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_data.html">read_data command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_dump.html">read_dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_restart.html">read_restart command</a></li>
<li class="toctree-l2"><a class="reference internal" href="region.html">region command</a></li>
<li class="toctree-l2"><a class="reference internal" href="replicate.html">replicate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="rerun.html">rerun command</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset_atoms.html">reset_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset_timestep.html">reset_timestep command</a></li>
<li class="toctree-l2"><a class="reference internal" href="restart.html">restart command</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">run command</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_style.html">run_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="set.html">set command</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">shell command</a></li>
<li class="toctree-l2"><a class="reference internal" href="special_bonds.html">special_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="suffix.html">suffix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="tad.html">tad command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper.html">temper command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper_grem.html">temper/grem command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper_npt.html">temper/npt command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo.html">thermo command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo_modify.html">thermo_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo_style.html">thermo_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="third_order.html">third_order command</a></li>
<li class="toctree-l2"><a class="reference internal" href="timer.html">timer command</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestep.html">timestep command</a></li>
<li class="toctree-l2"><a class="reference internal" href="uncompute.html">uncompute command</a></li>
<li class="toctree-l2"><a class="reference internal" href="undump.html">undump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="unfix.html">unfix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">units command</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable.html">variable command</a></li>
<li class="toctree-l2"><a class="reference internal" href="velocity.html">velocity command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_coeff.html">write_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_data.html">write_data command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_dump.html">write_dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_restart.html">write_restart command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="commands_list.html">Commands</a></li>
      <li class="breadcrumb-item active">balance command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="atom_style.html" class="btn btn-neutral float-left" title="atom_style command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bond_coeff.html" class="btn btn-neutral float-right" title="bond_coeff command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<section id="balance-command">
<span id="index-0"></span><h1>balance command<a class="headerlink" href="#balance-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">balance</span><span class="w"> </span><span class="n">thresh</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="n">...</span>
</pre></div>
</div>
<ul>
<li><p>thresh = imbalance threshold that must be exceeded to perform a re-balance</p></li>
<li><p>one style/arg pair can be used (or multiple for <em>x</em>,<em>y</em>,<em>z</em>)</p></li>
<li><p>style = <em>x</em> or <em>y</em> or <em>z</em> or <em>shift</em> or <em>rcb</em></p>
<pre class="literal-block"><em>x</em> args = <em>uniform</em> or Px-1 numbers between 0 and 1
  <em>uniform</em> = evenly spaced cuts between processors in x dimension
  numbers = Px-1 ascending values between 0 and 1, Px - # of processors in x dimension
  <em>x</em> can be specified together with <em>y</em> or <em>z</em>
<em>y</em> args = <em>uniform</em> or Py-1 numbers between 0 and 1
  <em>uniform</em> = evenly spaced cuts between processors in y dimension
  numbers = Py-1 ascending values between 0 and 1, Py - # of processors in y dimension
  <em>y</em> can be specified together with <em>x</em> or <em>z</em>
<em>z</em> args = <em>uniform</em> or Pz-1 numbers between 0 and 1
  <em>uniform</em> = evenly spaced cuts between processors in z dimension
  numbers = Pz-1 ascending values between 0 and 1, Pz - # of processors in z dimension
  <em>z</em> can be specified together with <em>x</em> or <em>y</em>
<em>shift</em> args = dimstr Niter stopthresh
  dimstr = sequence of letters containing &quot;x&quot; or &quot;y&quot; or &quot;z&quot;, each not more than once
  Niter = # of times to iterate within each dimension of dimstr sequence
  stopthresh = stop balancing when this imbalance threshold is reached
<em>rcb</em> args = none</pre>
</li>
<li><p>zero or more keyword/arg pairs may be appended</p></li>
<li><p>keyword = <em>weight</em> or <em>out</em></p>
<pre class="literal-block"><em>weight</em> style args = use weighted particle counts for the balancing
  <em>style</em> = <em>group</em> or <em>neigh</em> or <em>time</em> or <em>var</em> or <em>store</em>
    <em>group</em> args = Ngroup group1 weight1 group2 weight2 ...
      Ngroup = number of groups with assigned weights
      group1, group2, ... = group IDs
      weight1, weight2, ...   = corresponding weight factors
    <em>neigh</em> factor = compute weight based on number of neighbors
      factor = scaling factor (&gt; 0)
    <em>time</em> factor = compute weight based on time spend computing
      factor = scaling factor (&gt; 0)
    <em>var</em> name = take weight from atom-style variable
      name = name of the atom-style variable
    <em>store</em> name = store weight in custom atom property defined by <a class="reference internal" href="fix_property_atom.html"><span class="doc">fix property/atom</span></a> command
      name = atom property name (without d_ prefix)
<em>out</em> arg = filename
  filename = write each processor's subdomain to a file</pre>
</li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">balance</span><span class="w"> </span><span class="m">0.9</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">uniform</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="m">0.4</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="m">0.6</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.2</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="n">xz</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1.1</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="n">xz</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1.1</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="n">rcb</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">2</span><span class="w"> </span><span class="n">fast</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">slow</span><span class="w"> </span><span class="m">2.0</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="m">0.8</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="n">neigh</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">balance</span>
<span class="k">balance</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">tmp.balance</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>This command adjusts the size and shape of processor subdomains
within the simulation box, to attempt to balance the number of atoms
or particles and thus indirectly the computational cost (load) more
evenly across processors.  The load balancing is “static” in the sense
that this command performs the balancing once, before or between
simulations.  The processor subdomains will then remain static during
the subsequent run.  To perform “dynamic” balancing, see the <a class="reference internal" href="fix_balance.html"><span class="doc">fix
balance</span></a> command, which can adjust processor subdomain
sizes and shapes on-the-fly during a <a class="reference internal" href="run.html"><span class="doc">run</span></a>.</p>
<p>Load-balancing is typically most useful if the particles in the
simulation box have a spatially-varying density distribution or when
the computational cost varies significantly between different
particles.  E.g. a model of a vapor/liquid interface, or a solid with
an irregular-shaped geometry containing void regions, or <a class="reference internal" href="pair_hybrid.html"><span class="doc">hybrid
pair style simulations</span></a> which combine pair styles with
different computational cost.  In these cases, the LAMMPS default of
dividing the simulation box volume into a regular-spaced grid of 3d
bricks, with one equal-volume subdomain per processor, may assign
numbers of particles per processor in a way that the computational
effort varies significantly.  This can lead to poor performance when
the simulation is run in parallel.</p>
<p>The balancing can be performed with or without per-particle weighting.
With no weighting, the balancing attempts to assign an equal number of
particles to each processor.  With weighting, the balancing attempts
to assign an equal aggregate computational weight to each processor,
which typically induces a different number of atoms assigned to each
processor.  Details on the various weighting options and examples for
how they can be used are <a class="reference internal" href="#weighted-balance"><span class="std std-ref">given below</span></a>.</p>
<p>Note that the <a class="reference internal" href="processors.html"><span class="doc">processors</span></a> command allows some
control over how the box volume is split across processors.
Specifically, for a Px by Py by Pz grid of processors, it allows
choice of Px, Py, and Pz, subject to the constraint that Px * Py *
Pz = P, the total number of processors.  This is sufficient to achieve
good load-balance for some problems on some processor counts.
However, all the processor subdomains will still have the same shape
and same volume.</p>
<p>The requested load-balancing operation is only performed if the
current “imbalance factor” in particles owned by each processor
exceeds the specified <em>thresh</em> parameter.  The imbalance factor is
defined as the maximum number of particles (or weight) owned by any
processor, divided by the average number of particles (or weight) per
processor.  Thus an imbalance factor of 1.0 is perfect balance.</p>
<p>As an example, for 10000 particles running on 10 processors, if the
most heavily loaded processor has 1200 particles, then the factor is
1.2, meaning there is a 20% imbalance.  Note that a re-balance can be
forced even if the current balance is perfect (1.0) be specifying a
<em>thresh</em> &lt; 1.0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Balancing is performed even if the imbalance factor does not
exceed the <em>thresh</em> parameter if a “grid” style is specified when the
current partitioning is “tiled”.  The meaning of “grid” vs “tiled” is
explained below.  This is to allow forcing of the partitioning to
“grid” so that the <a class="reference internal" href="comm_style.html"><span class="doc">comm_style brick</span></a> command can then
be used to replace a current <a class="reference internal" href="comm_style.html"><span class="doc">comm_style tiled</span></a>
setting.</p>
</div>
<p>When the balance command completes, it prints statistics about the
result, including the change in the imbalance factor and the change in
the maximum number of particles on any processor.  For “grid” methods
(defined below) that create a logical 3d grid of processors, the
positions of all cutting planes in each of the 3 dimensions (as
fractions of the box length) are also printed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command attempts to minimize the imbalance factor, as
defined above.  But depending on the method a perfect balance (1.0)
may not be achieved.  For example, “grid” methods (defined below) that
create a logical 3d grid cannot achieve perfect balance for many
irregular distributions of particles.  Likewise, if a portion of the
system is a perfect lattice, e.g. the initial system is generated by
the <a class="reference internal" href="create_atoms.html"><span class="doc">create_atoms</span></a> command, then “grid” methods may
be unable to achieve exact balance.  This is because entire lattice
planes will be owned or not owned by a single processor.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The imbalance factor is also an estimate of the maximum speed-up
you can hope to achieve by running a perfectly balanced simulation
versus an imbalanced one.  In the example above, the 10000 particle
simulation could run up to 20% faster if it were perfectly balanced,
versus when imbalanced.  However, computational cost is not strictly
proportional to particle count, and changing the relative size and
shape of processor subdomains may lead to additional computational
and communication overheads, e.g. in the PPPM solver used via the
<a class="reference internal" href="kspace_style.html"><span class="doc">kspace_style</span></a> command.  Thus you should benchmark
the run times of a simulation before and after balancing.</p>
</div>
<hr class="docutils" />
<p>The method used to perform a load balance is specified by one of the
listed styles (or more in the case of <em>x</em>,<em>y</em>,<em>z</em>), which are
described in detail below.  There are 2 kinds of styles.</p>
<p>The <em>x</em>, <em>y</em>, <em>z</em>, and <em>shift</em> styles are “grid” methods which
produce a logical 3d grid of processors.  They operate by changing the
cutting planes (or lines) between processors in 3d (or 2d), to adjust
the volume (area in 2d) assigned to each processor, as in the
following 2d diagram where processor subdomains are shown and
particles are colored by the processor that owns them.</p>
<p><a class="reference internal" href="_images/balance_uniform.jpg"><img alt="balance1" src="_images/balance_uniform.jpg" style="width: 32%;" /></a>  <a class="reference internal" href="_images/balance_nonuniform.jpg"><img alt="balance2" src="_images/balance_nonuniform.jpg" style="width: 32%;" /></a>  <a class="reference internal" href="_images/balance_rcb.jpg"><img alt="balance3" src="_images/balance_rcb.jpg" style="width: 32%;" /></a></p>
<p>The leftmost diagram is the default partitioning of the simulation box
across processors (one sub-box for each of 16 processors); the middle
diagram is after a “grid” method has been applied.  The <em>rcb</em> style is
a “tiling” method which does not produce a logical 3d grid of
processors.  Rather it tiles the simulation domain with rectangular
sub-boxes of varying size and shape in an irregular fashion so as to
have equal numbers of particles (or weight) in each sub-box, as in the
rightmost diagram above.</p>
<p>The “grid” methods can be used with either of the <a class="reference internal" href="comm_style.html"><span class="doc">comm_style</span></a> command options, <em>brick</em> or <em>tiled</em>.  The “tiling”
methods can only be used with <a class="reference internal" href="comm_style.html"><span class="doc">comm_style tiled</span></a>.
Note that it can be useful to use a “grid” method with
<a class="reference internal" href="comm_style.html"><span class="doc">comm_style tiled</span></a> to return the domain partitioning
to a logical 3d grid of processors so that “comm_style brick” can
afterwords be specified for subsequent <a class="reference internal" href="run.html"><span class="doc">run</span></a> commands.</p>
<p>When a “grid” method is specified, the current domain partitioning can
be either a logical 3d grid or a tiled partitioning.  In the former
case, the current logical 3d grid is used as a starting point and
changes are made to improve the imbalance factor.  In the latter case,
the tiled partitioning is discarded and a logical 3d grid is created
with uniform spacing in all dimensions.  This becomes the starting
point for the balancing operation.</p>
<p>When a “tiling” method is specified, the current domain partitioning
(“grid” or “tiled”) is ignored, and a new partitioning is computed
from scratch.</p>
<hr class="docutils" />
<p>The <em>x</em>, <em>y</em>, and <em>z</em> styles invoke a “grid” method for balancing, as
described above.  Note that any or all of these 3 styles can be
specified together, one after the other, but they cannot be used with
any other style.  This style adjusts the position of cutting planes
between processor subdomains in specific dimensions.  Only the
specified dimensions are altered.</p>
<p>The <em>uniform</em> argument spaces the planes evenly, as in the left
diagrams above.  The <em>numeric</em> argument requires listing Ps-1 numbers
that specify the position of the cutting planes.  This requires
knowing Ps = Px or Py or Pz = the number of processors assigned by
LAMMPS to the relevant dimension.  This assignment is made (and the
Px, Py, Pz values printed out) when the simulation box is created by
the “create_box” or “read_data” or “read_restart” command and is
influenced by the settings of the <a class="reference internal" href="processors.html"><span class="doc">processors</span></a>
command.</p>
<p>Each of the numeric values must be between 0 and 1, and they must be
listed in ascending order.  They represent the fractional position of
the cutting place.  The left (or lower) edge of the box is 0.0, and
the right (or upper) edge is 1.0.  Neither of these values is
specified.  Only the interior Ps-1 positions are specified.  Thus is
there are 2 processors in the x dimension, you specify a single value
such as 0.75, which would make the left processor’s subdomain 3x
larger than the right processor’s subdomain.</p>
<hr class="docutils" />
<p>The <em>shift</em> style invokes a “grid” method for balancing, as
described above.  It changes the positions of cutting planes between
processors in an iterative fashion, seeking to reduce the imbalance
factor, similar to how the <a class="reference internal" href="fix_balance.html"><span class="doc">fix balance shift</span></a>
command operates.</p>
<p>The <em>dimstr</em> argument is a string of characters, each of which must be
an “x” or “y” or “z”. Each character can appear zero or one time,
since there is no advantage to balancing on a dimension more than
once.  You should normally only list dimensions where you expect there
to be a density variation in the particles.</p>
<p>Balancing proceeds by adjusting the cutting planes in each of the
dimensions listed in <em>dimstr</em>, one dimension at a time.  For a single
dimension, the balancing operation (described below) is iterated on up
to <em>Niter</em> times.  After each dimension finishes, the imbalance factor
is re-computed, and the balancing operation halts if the <em>stopthresh</em>
criterion is met.</p>
<p>A re-balance operation in a single dimension is performed using a
recursive multisectioning algorithm, where the position of each
cutting plane (line in 2d) in the dimension is adjusted independently.
This is similar to a recursive bisectioning for a single value, except
that the bounds used for each bisectioning take advantage of
information from neighboring cuts if possible.  At each iteration, the
count of particles on either side of each plane is tallied.  If the
counts do not match the target value for the plane, the position of
the cut is adjusted to be halfway between a low and high bound.  The
low and high bounds are adjusted on each iteration, using new count
information, so that they become closer together over time.  Thus as
the recursion progresses, the count of particles on either side of the
plane gets closer to the target value.</p>
<p>After the balanced plane positions are determined, if any pair of
adjacent planes are closer together than the neighbor skin distance
(as specified by the <a class="reference internal" href="neigh_modify.html"><span class="doc">neigh_modify</span></a> command), then
the plane positions are shifted to separate them by at least this
amount.  This is to prevent particles being lost when dynamics are run
with processor subdomains that are too narrow in one or more
dimensions.</p>
<p>Once the re-balancing is complete and final processor subdomains
assigned, particles are migrated to their new owning processor, and
the balance procedure ends.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At each re-balance operation, the bisectioning for each cutting
plane (line in 2d) typically starts with low and high bounds separated
by the extent of a processor’s subdomain in one dimension.  The size
of this bracketing region shrinks by 1/2 every iteration.  Thus if
<em>Niter</em> is specified as 10, the cutting plane will typically be
positioned to 1 part in 1000 accuracy (relative to the perfect target
position).  For <em>Niter</em> = 20, it will be accurate to 1 part in a
million.  Thus there is no need to set <em>Niter</em> to a large value.
LAMMPS will check if the threshold accuracy is reached (in a
dimension) is less iterations than <em>Niter</em> and exit early.  However,
<em>Niter</em> should also not be set too small, since it will take roughly
the same number of iterations to converge even if the cutting plane is
initially close to the target value.</p>
</div>
<hr class="docutils" />
<p>The <em>rcb</em> style invokes a “tiled” method for balancing, as described
above.  It performs a recursive coordinate bisectioning (RCB) of the
simulation domain. The basic idea is as follows.</p>
<p>The simulation domain is cut into 2 boxes by an axis-aligned cut in
one of the dimensions, leaving one new sub-box on either side of the
cut.  Which dimension is chosen for the cut depends on the particle
(weight) distribution within the parent box.  Normally the longest
dimension of the box is cut, but if all (or most) of the particles are
at one end of the box, a cut may be performed in another dimension to
induce sub-boxes that are more cube-ish (3d) or square-ish (2d) in
shape.</p>
<p>After the cut is made, all the processors are also partitioned into 2
groups, half assigned to the box on the lower side of the cut, and
half to the box on the upper side.  (If the processor count is odd,
one side gets an extra processor.)  The cut is positioned so that the
number of (weighted) particles in the lower box is exactly the number
that the processors assigned to that box should own for load balance
to be perfect.  This also makes load balance for the upper box
perfect.  The positioning of the cut is done iteratively, by a
bisectioning method (median search).  Note that counting particles on
either side of the cut requires communication between all processors
at each iteration.</p>
<p>That is the procedure for the first cut.  Subsequent cuts are made
recursively, in exactly the same manner.  The subset of processors
assigned to each box make a new cut in one dimension of that box,
splitting the box, the subset of processors, and the particles in the
box in two.  The recursion continues until every processor is assigned
a sub-box of the entire simulation domain, and owns the (weighted)
particles in that sub-box.</p>
<hr class="docutils" />
<p id="weighted-balance">This subsection describes how to perform weighted load balancing
using the <em>weight</em> keyword.</p>
<p>By default, all particles have a weight of 1.0, which means each
particle is assumed to require the same amount of computation during a
timestep.  There are, however, scenarios where this is not a good
assumption.  Measuring the computational cost for each particle
accurately would be impractical and slow down the computation.
Instead the <em>weight</em> keyword implements several ways to influence the
per-particle weights empirically by properties readily available or
using the user’s knowledge of the system.  Note that the absolute
value of the weights are not important; only their relative ratios
affect which particle is assigned to which processor.  A particle with
a weight of 2.5 is assumed to require 5x more computational than a
particle with a weight of 0.5.  For all the options below the weight
assigned to a particle must be a positive value; an error will be be
generated if a weight is &lt;= 0.0.</p>
<p>Below is a list of possible weight options with a short description of
their usage and some example scenarios where they might be applicable.
It is possible to apply multiple weight flags and the weightings they
induce will be combined through multiplication.  Most of the time,
however, it is sufficient to use just one method.</p>
<p>The <em>group</em> weight style assigns weight factors to specified
<a class="reference internal" href="group.html"><span class="doc">groups</span></a> of particles.  The <em>group</em> style keyword is
followed by the number of groups, then pairs of group IDs and the
corresponding weight factor.  If a particle belongs to none of the
specified groups, its weight is not changed.  If it belongs to
multiple groups, its weight is the product of the weight factors.</p>
<p>This weight style is useful in combination with pair style
<a class="reference internal" href="pair_hybrid.html"><span class="doc">hybrid</span></a>, e.g. when combining a more costly many-body
potential with a fast pairwise potential.  It is also useful when
using <a class="reference internal" href="run_style.html"><span class="doc">run_style respa</span></a> where some portions of the
system have many bonded interactions and others none.  It assumes that
the computational cost for each group remains constant over time.
This is a purely empirical weighting, so a series test runs to tune
the assigned weight factors for optimal performance is recommended.</p>
<p>The <em>neigh</em> weight style assigns the same weight to each particle
owned by a processor based on the total count of neighbors in the
neighbor list owned by that processor.  The motivation is that more
neighbors means a higher computational cost.  The style does not use
neighbors per atom to assign a unique weight to each atom, because
that value can vary depending on how the neighbor list is built.</p>
<p>The <em>factor</em> setting is applied as an overall scale factor to the
<em>neigh</em> weights which allows adjustment of their impact on the
balancing operation.  The specified <em>factor</em> value must be positive.
A value &gt; 1.0 will increase the weights so that the ratio of max
weight to min weight increases by <em>factor</em>.  A value &lt; 1.0 will
decrease the weights so that the ratio of max weight to min weight
decreases by <em>factor</em>.  In both cases the intermediate weight values
increase/decrease proportionally as well.  A value = 1.0 has no effect
on the <em>neigh</em> weights.  As a rule of thumb, we have found a <em>factor</em>
of about 0.8 often results in the best performance, since the number
of neighbors is likely to overestimate the ideal weight.</p>
<p>This weight style is useful for systems where there are different
cutoffs used for different pairs of interactions, or the density
fluctuates, or a large number of particles are in the vicinity of a
wall, or a combination of these effects.  If a simulation uses
multiple neighbor lists, this weight style will use the first suitable
neighbor list it finds.  It will not request or compute a new list.  A
warning will be issued if there is no suitable neighbor list available
or if it is not current, e.g. if the balance command is used before a
<a class="reference internal" href="run.html"><span class="doc">run</span></a> or <a class="reference internal" href="minimize.html"><span class="doc">minimize</span></a> command is used, in which
case the neighbor list may not yet have been built.  In this case no
weights are computed.  Inserting a <a class="reference internal" href="run.html"><span class="doc">run 0 post no</span></a> command
before issuing the <em>balance</em> command, may be a workaround for this
case, as it will induce the neighbor list to be built.</p>
<p>The <em>time</em> weight style uses <a class="reference internal" href="timer.html"><span class="doc">timer data</span></a> to estimate
weights.  It assigns the same weight to each particle owned by a
processor based on the total computational time spent by that
processor.  See details below on what time window is used.  It uses
the same timing information as is used for the <a class="reference internal" href="Run_output.html"><span class="doc">MPI task timing
breakdown</span></a>, namely, for sections <em>Pair</em>, <em>Bond</em>,
<em>Kspace</em>, and <em>Neigh</em>.  The time spent in those portions of the
timestep are measured for each MPI rank, summed, then divided by the
number of particles owned by that processor.  I.e. the weight is an
effective CPU time/particle averaged over the particles on that
processor.</p>
<p>The <em>factor</em> setting is applied as an overall scale factor to the
<em>time</em> weights which allows adjustment of their impact on the
balancing operation.  The specified <em>factor</em> value must be positive.
A value &gt; 1.0 will increase the weights so that the ratio of max
weight to min weight increases by <em>factor</em>.  A value &lt; 1.0 will
decrease the weights so that the ratio of max weight to min weight
decreases by <em>factor</em>.  In both cases the intermediate weight values
increase/decrease proportionally as well.  A value = 1.0 has no effect
on the <em>time</em> weights.  As a rule of thumb, effective values to use
are typically between 0.5 and 1.2.  Note that the timer quantities
mentioned above can be affected by communication which occurs in the
middle of the operations, e.g. pair styles with intermediate exchange
of data witin the force computation, and likewise for KSpace solves.</p>
<p>When using the <em>time</em> weight style with the <em>balance</em> command, the
timing data is taken from the preceding run command, i.e. the timings
are for the entire previous run.  For the <em>fix balance</em> command the
timing data is for only the timesteps since the last balancing
operation was performed.  If timing information for the required
sections is not available, e.g. at the beginning of a run, or when the
<a class="reference internal" href="timer.html"><span class="doc">timer</span></a> command is set to either <em>loop</em> or <em>off</em>, a warning
is issued.  In this case no weights are computed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <em>time</em> weight style is the most generic option, and should
be tried first, unless the <em>group</em> style is easily applicable.
However, since the computed cost function is averaged over all
particles on a processor, the weights may not be highly accurate.
This style can also be effective as a secondary weight in combination
with either <em>group</em> or <em>neigh</em> to offset some of inaccuracies in
either of those heuristics.</p>
</div>
<p>The <em>var</em> weight style assigns per-particle weights by evaluating an
<a class="reference internal" href="variable.html"><span class="doc">atom-style variable</span></a> specified by <em>name</em>.  This is
provided as a more flexible alternative to the <em>group</em> weight style,
allowing definition of a more complex heuristics based on information
(global and per atom) available inside of LAMMPS.  For example,
atom-style variables can reference the position of a particle, its
velocity, the volume of its Voronoi cell, etc.</p>
<p>The <em>store</em> weight style does not compute a weight factor.  Instead it
stores the current accumulated weights in a custom per-atom vector
specified by <em>name</em>.  This must be a vector defined as <em>d_name</em> via
the <a class="reference internal" href="fix_property_atom.html"><span class="doc">fix property/atom</span></a> command.  This means
the values in the vector can be read as part of a data file with the
<a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> command or specified with the <a class="reference internal" href="set.html"><span class="doc">set</span></a> command.  These weights can also be output in a <a class="reference internal" href="dump.html"><span class="doc">dump</span></a> file, so this is a way to examine, debug, or visualize the
per-particle weights used during the load-balancing operation.</p>
<p>Note that the name of the custom per-atom vector is specified just
as <em>name</em>, not as <em>d_name</em> as it is for other commands that use
different kinds of custom atom vectors or arrays as arguments.</p>
<hr class="docutils" />
<p>The <em>out</em> keyword writes a text file to the specified <em>filename</em> with
the results of the balancing operation.  The file contains the bounds
of the subdomain for each processor after the balancing operation
completes.  The format of the file is compatible with the
<a class="reference external" href="https://lammps.github.io/pizza">Pizza.py</a> <em>mdump</em> tool which has support for manipulating and
visualizing mesh files.  An example is shown here for a balancing by 4
processors for a 2d problem:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ITEM: TIMESTEP
0
ITEM: NUMBER OF NODES
16
ITEM: BOX BOUNDS
0 10
0 10
0 10
ITEM: NODES
1 1 0 0 0
2 1 5 0 0
3 1 5 5 0
4 1 0 5 0
5 1 5 0 0
6 1 10 0 0
7 1 10 5 0
8 1 5 5 0
9 1 0 5 0
10 1 5 5 0
11 1 5 10 0
12 1 10 5 0
13 1 5 5 0
14 1 10 5 0
15 1 10 10 0
16 1 5 10 0
ITEM: TIMESTEP
0
ITEM: NUMBER OF SQUARES
4
ITEM: SQUARES
1 1 1 2 3 4
2 1 5 6 7 8
3 1 9 10 11 12
4 1 13 14 15 16
</pre></div>
</div>
<p>The coordinates of all the vertices are listed in the NODES section, 5
per processor.  Note that the 4 subdomains share vertices, so there
will be duplicate nodes in the list.</p>
<p>The “SQUARES” section lists the node IDs of the 4 vertices in a
rectangle for each processor (1 to 4).</p>
<p>For a 3d problem, the syntax is similar with 8 vertices listed for
each processor, instead of 4, and “SQUARES” replaced by “CUBES”.</p>
</section>
<hr class="docutils" />
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>For 2d simulations, the <em>z</em> style cannot be used.  Nor can a “z”
appear in <em>dimstr</em> for the <em>shift</em> style.</p>
<p>Balancing through recursive bisectioning (<em>rcb</em> style) requires
<a class="reference internal" href="comm_style.html"><span class="doc">comm_style tiled</span></a></p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="group.html"><span class="doc">group</span></a>, <a class="reference internal" href="processors.html"><span class="doc">processors</span></a>,
<a class="reference internal" href="fix_balance.html"><span class="doc">fix balance</span></a>, <a class="reference internal" href="comm_style.html"><span class="doc">comm_style</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>none</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="atom_style.html" class="btn btn-neutral float-left" title="atom_style command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bond_coeff.html" class="btn btn-neutral float-right" title="bond_coeff command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>