<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dihedral_style spherical command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/dihedral_spherical.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dihedral_style table command" href="dihedral_table.html" />
    <link rel="prev" title="dihedral_style quadratic command" href="dihedral_quadratic.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dihedral_charmm.html">dihedral_style charmm command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_charmm.html#dihedral-style-charmmfsw-command">dihedral_style charmmfsw command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_class2.html">dihedral_style class2 command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_coeff.html">dihedral_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_cosine_shift_exp.html">dihedral_style cosine/shift/exp command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_fourier.html">dihedral_style fourier command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_harmonic.html">dihedral_style harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_helix.html">dihedral_style helix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_hybrid.html">dihedral_style hybrid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_lepton.html">dihedral_style lepton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_multi_harmonic.html">dihedral_style multi/harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_nharmonic.html">dihedral_style nharmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_none.html">dihedral_style none command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_opls.html">dihedral_style opls command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_quadratic.html">dihedral_style quadratic command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">dihedral_style spherical command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_style.html">dihedral_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html">dihedral_style table command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html#dihedral-style-table-cut-command">dihedral_style table/cut command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_write.html">dihedral_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_zero.html">dihedral_style zero command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="dihedrals.html">Dihedral Styles</a></li>
      <li class="breadcrumb-item active">dihedral_style spherical command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="dihedral_quadratic.html" class="btn btn-neutral float-left" title="dihedral_style quadratic command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_table.html" class="btn btn-neutral float-right" title="dihedral_style table command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<section id="dihedral-style-spherical-command">
<span id="index-0"></span><h1>dihedral_style spherical command<a class="headerlink" href="#dihedral-style-spherical-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_style</span><span class="w"> </span><span class="n">spherical</span>
</pre></div>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="m">286.1</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">124</span><span class="w">  </span><span class="m">1</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">90.0</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">90.0</span><span class="w"> </span><span class="m">0</span>
<span class="k">dihedral_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="m">69.3</span><span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">93.9</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">90</span><span class="w">   </span><span class="m">0</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">90</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="o">&amp;</span>
<span class="w">                    </span><span class="m">49.1</span><span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0.00</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">74.4</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="m">0.00</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="o">&amp;</span>
<span class="w">                    </span><span class="m">25.2</span><span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0.00</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="m">0.00</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">48.1</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The <em>spherical</em> dihedral style uses the potential:</p>
<img alt="_images/dihedral_spherical_angles.jpg" class="align-center" src="_images/dihedral_spherical_angles.jpg" />
<div class="math notranslate nohighlight">
\[\begin{split}E(\phi,\theta_1,\theta_2) &amp; = \sum_{i=1}^N\nolimits\ C_i\ \Phi_i(\phi)\ \Theta_{1i}(\theta_1)\ \Theta_{2i}(\theta_2) \\
\Phi_{i}(\phi)            &amp; = u_i - \mathrm{cos}((\phi   - a_i)K_i) \\
\Theta_{1i}(\theta_1)     &amp; = v_i - \mathrm{cos}((\theta_1-b_i)L_i) \\
\Theta_{2i}(\theta_2)     &amp; = w_i - \mathrm{cos}((\theta_2-c_i)M_i)\end{split}\]</div>
<p>For this dihedral style, the energy can be any function that combines the
4-body dihedral-angle (<span class="math notranslate nohighlight">\(\phi\)</span>) and the two 3-body bond-angles
(<span class="math notranslate nohighlight">\(\theta_1\)</span>, <span class="math notranslate nohighlight">\(\theta_2\)</span>).
For this reason, there is usually no need to define 3-body “angle” forces
separately for the atoms participating in these interactions.
It is probably more efficient to incorporate 3-body angle forces into
the dihedral interaction even if it requires adding additional terms to
the expansion (as was done in the second example).  A careful choice of
parameters can prevent singularities that occur with traditional
force-fields whenever theta1 or theta2 approach 0 or 180 degrees.</p>
<p>The last example above corresponds to an interaction with a single energy
minima located near <span class="math notranslate nohighlight">\(\phi=93.9\)</span>, <span class="math notranslate nohighlight">\(\theta_1=74.4\)</span>,
<span class="math notranslate nohighlight">\(\theta_2=48.1\)</span> degrees, and it remains numerically stable at all
angles (<span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\theta_1\)</span>, <span class="math notranslate nohighlight">\(\theta_2\)</span>). In this example,
the coefficients 49.1, and 25.2 can be physically interpreted as the
harmonic spring constants for theta1 and theta2 around their minima.
The coefficient 69.3 is the harmonic spring constant for phi after
division by sin(74.4)*sin(48.1) (the minima positions for theta1 and theta2).</p>
<p>The following coefficients must be defined for each dihedral type via the
<a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a> command as in the example above, or in
the Dihedral Coeffs section of a data file read by the
<a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> command:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> (integer &gt;= 1)</p></li>
<li><p><span class="math notranslate nohighlight">\(C_1\)</span> (energy)</p></li>
<li><p><span class="math notranslate nohighlight">\(K_1\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(a_1\)</span> (degrees)</p></li>
<li><p><span class="math notranslate nohighlight">\(u_1\)</span> (typically 0.0 or 1.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(L_1\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(b_1\)</span> (degrees, typically 0.0 or 90.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(v_1\)</span> (typically 0.0 or 1.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(M_1\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(c_1\)</span> (degrees, typically 0.0 or 90.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(w_1\)</span> (typically 0.0 or 1.0)</p></li>
<li><p>[…]</p></li>
<li><p><span class="math notranslate nohighlight">\(C_n\)</span> (energy)</p></li>
<li><p><span class="math notranslate nohighlight">\(K_n\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(a_n\)</span> (degrees)</p></li>
<li><p><span class="math notranslate nohighlight">\(u_n\)</span> (typically 0.0 or 1.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(L_n\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(b_n\)</span> (degrees, typically 0.0 or 90.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(v_n\)</span> (typically 0.0 or 1.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(M_n\)</span> (typically an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(c_n\)</span> (degrees, typically 0.0 or 90.0)</p></li>
<li><p><span class="math notranslate nohighlight">\(w_n\)</span> (typically 0.0 or 1.0)</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>This dihedral style can only be used if LAMMPS was built with the
EXTRA-MOLECULE package.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> doc
page for more info.</p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>none</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dihedral_quadratic.html" class="btn btn-neutral float-left" title="dihedral_style quadratic command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_table.html" class="btn btn-neutral float-right" title="dihedral_style table command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>