<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>compute sna/atom command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/compute_sna_atom.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="compute sph/e/atom command" href="compute_sph_e_atom.html" />
    <link rel="prev" title="compute smd/vol command" href="compute_smd_vol.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="computes.html">Computes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="compute_ackland_atom.html">compute ackland/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_adf.html">compute adf command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_angle.html">compute angle command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_angle_local.html">compute angle/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_angmom_chunk.html">compute angmom/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ave_sphere_atom.html">compute ave/sphere/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_basal_atom.html">compute basal/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_body_local.html">compute body/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_bond.html">compute bond command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_bond_local.html">compute bond/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_born_matrix.html">compute born/matrix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_centro_atom.html">compute centro/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_chunk_atom.html">compute chunk/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_chunk_spread_atom.html">compute chunk/spread/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_cluster_atom.html">compute cluster/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_cluster_atom.html#compute-fragment-atom-command">compute fragment/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_cluster_atom.html#compute-aggregate-atom-command">compute aggregate/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_cna_atom.html">compute cna/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_cnp_atom.html">compute cnp/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_com.html">compute com command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_com_chunk.html">compute com/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_contact_atom.html">compute contact/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_coord_atom.html">compute coord/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_damage_atom.html">compute damage/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dihedral.html">compute dihedral command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dihedral_local.html">compute dihedral/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dilatation_atom.html">compute dilatation/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dipole.html">compute dipole command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dipole_chunk.html">compute dipole/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_displace_atom.html">compute displace/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dpd.html">compute dpd command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_dpd_atom.html">compute dpd/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_edpd_temp_atom.html">compute edpd/temp/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_efield_atom.html">compute efield/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_efield_wolf_atom.html">compute efield/wolf/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_entropy_atom.html">compute entropy/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_erotate_asphere.html">compute erotate/asphere command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_erotate_rigid.html">compute erotate/rigid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_erotate_sphere.html">compute erotate/sphere command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_erotate_sphere_atom.html">compute erotate/sphere/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_event_displace.html">compute event/displace command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_fabric.html">compute fabric command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_fep.html">compute fep command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_fep_ta.html">compute fep/ta command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_global_atom.html">compute global/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_group_group.html">compute group/group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_gyration.html">compute gyration command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_gyration_chunk.html">compute gyration/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_gyration_shape.html">compute gyration/shape command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_gyration_shape_chunk.html">compute gyration/shape/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_heat_flux.html">compute heat/flux command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_hexorder_atom.html">compute hexorder/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_hma.html">compute hma command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_improper.html">compute improper command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_improper_local.html">compute improper/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_inertia_chunk.html">compute inertia/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ke.html">compute ke command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ke_atom.html">compute ke/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ke_atom_eff.html">compute ke/atom/eff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ke_eff.html">compute ke/eff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ke_rigid.html">compute ke/rigid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_mliap.html">compute mliap command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_modify.html">compute_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_momentum.html">compute momentum command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_msd.html">compute msd command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_msd_chunk.html">compute msd/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_msd_nongauss.html">compute msd/nongauss command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_nbond_atom.html">compute nbond/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_omega_chunk.html">compute omega/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_orientorder_atom.html">compute orientorder/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pair.html">compute pair command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pair_local.html">compute pair/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pe.html">compute pe command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pe_atom.html">compute pe/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_plasticity_atom.html">compute plasticity/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pressure.html">compute pressure command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_pressure_uef.html">compute pressure/uef command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_property_atom.html">compute property/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_property_chunk.html">compute property/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_property_grid.html">compute property/grid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_property_local.html">compute property/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ptm_atom.html">compute ptm/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_rdf.html">compute rdf command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_reduce.html">compute reduce command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_reduce.html#compute-reduce-region-command">compute reduce/region command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_reduce_chunk.html">compute reduce/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_rigid_local.html">compute rigid/local command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_saed.html">compute saed command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_slice.html">compute slice command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_contact_radius.html">compute smd/contact/radius command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_damage.html">compute smd/damage command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_hourglass_error.html">compute smd/hourglass/error command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_internal_energy.html">compute smd/internal/energy command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_plastic_strain.html">compute smd/plastic/strain command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_plastic_strain_rate.html">compute smd/plastic/strain/rate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_rho.html">compute smd/rho command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_defgrad.html">compute smd/tlsph/defgrad command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_dt.html">compute smd/tlsph/dt command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_num_neighs.html">compute smd/tlsph/num/neighs command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_shape.html">compute smd/tlsph/shape command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_strain.html">compute smd/tlsph/strain command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_strain_rate.html">compute smd/tlsph/strain/rate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_tlsph_stress.html">compute smd/tlsph/stress command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_triangle_vertices.html">compute smd/triangle/vertices command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_ulsph_effm.html">compute smd/ulsph/effm command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_ulsph_num_neighs.html">compute smd/ulsph/num/neighs command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_ulsph_strain.html">compute smd/ulsph/strain command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_ulsph_strain_rate.html">compute smd/ulsph/strain/rate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_ulsph_stress.html">compute smd/ulsph/stress command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_smd_vol.html">compute smd/vol command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">compute sna/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-snad-atom-command">compute snad/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-snav-atom-command">compute snav/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-snap-command">compute snap command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-sna-grid-command">compute sna/grid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-sna-grid-local-command">compute sna/grid/local command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-info">Output info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="compute_sph_e_atom.html">compute sph/e/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_sph_rho_atom.html">compute sph/rho/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_sph_t_atom.html">compute sph/t/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_spin.html">compute spin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_atom.html">compute stress/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_atom.html#compute-centroid-stress-atom-command">compute centroid/stress/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_mop.html">compute stress/mop command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_mop.html#compute-stress-mop-profile-command">compute stress/mop/profile command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_profile.html">compute stress/cartesian command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_profile.html#compute-stress-cylinder-command">compute stress/cylinder command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_stress_profile.html#compute-stress-spherical-command">compute stress/spherical command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html">compute force/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html#compute-heat-flux-tally-command">compute heat/flux/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html#compute-heat-flux-virial-tally-command">compute heat/flux/virial/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html#compute-pe-tally-command">compute pe/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html#compute-pe-mol-tally-command">compute pe/mol/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tally.html#compute-stress-tally-command">compute stress/tally command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_tdpd_cc_atom.html">compute tdpd/cc/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp.html">compute temp command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_asphere.html">compute temp/asphere command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_body.html">compute temp/body command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_chunk.html">compute temp/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_com.html">compute temp/com command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_cs.html">compute temp/cs command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_deform.html">compute temp/deform command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_deform_eff.html">compute temp/deform/eff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_drude.html">compute temp/drude command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_eff.html">compute temp/eff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_partial.html">compute temp/partial command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_profile.html">compute temp/profile command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_ramp.html">compute temp/ramp command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_region.html">compute temp/region command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_region_eff.html">compute temp/region/eff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_rotate.html">compute temp/rotate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_sphere.html">compute temp/sphere command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_temp_uef.html">compute temp/uef command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_ti.html">compute ti command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_torque_chunk.html">compute torque/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_vacf.html">compute vacf command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_vcm_chunk.html">compute vcm/chunk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_viscosity_cos.html">compute viscosity/cos command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_voronoi_atom.html">compute voronoi/atom command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_xrd.html">compute xrd command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="computes.html">Computes</a></li>
      <li class="breadcrumb-item active">compute sna/atom command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="compute_smd_vol.html" class="btn btn-neutral float-left" title="compute smd/vol command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="compute_sph_e_atom.html" class="btn btn-neutral float-right" title="compute sph/e/atom command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><span class="target" id="index-2"></span><span class="target" id="index-3"></span><span class="target" id="index-4"></span><section id="compute-sna-atom-command">
<span id="index-5"></span><h1>compute sna/atom command<a class="headerlink" href="#compute-sna-atom-command" title="Permalink to this heading">¶</a></h1>
</section>
<section id="compute-snad-atom-command">
<h1>compute snad/atom command<a class="headerlink" href="#compute-snad-atom-command" title="Permalink to this heading">¶</a></h1>
</section>
<section id="compute-snav-atom-command">
<h1>compute snav/atom command<a class="headerlink" href="#compute-snav-atom-command" title="Permalink to this heading">¶</a></h1>
</section>
<section id="compute-snap-command">
<h1>compute snap command<a class="headerlink" href="#compute-snap-command" title="Permalink to this heading">¶</a></h1>
</section>
<section id="compute-sna-grid-command">
<h1>compute sna/grid command<a class="headerlink" href="#compute-sna-grid-command" title="Permalink to this heading">¶</a></h1>
</section>
<section id="compute-sna-grid-local-command">
<h1>compute sna/grid/local command<a class="headerlink" href="#compute-sna-grid-local-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>compute ID group-ID sna/atom rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID snad/atom rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID snav/atom rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID snap rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID snap rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID sna/grid nx ny nz rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
compute ID group-ID sna/grid/local nx ny nz rcutfac rfac0 twojmax R_1 R_2 ... w_1 w_2 ... keyword values ...
</pre></div>
</div>
<ul>
<li><p>ID, group-ID are documented in <a class="reference internal" href="compute.html"><span class="doc">compute</span></a> command</p></li>
<li><p>sna/atom = style name of this compute command</p></li>
<li><p>rcutfac = scale factor applied to all cutoff radii (positive real)</p></li>
<li><p>rfac0 = parameter in distance to angle conversion (0 &lt; rcutfac &lt; 1)</p></li>
<li><p>twojmax = band limit for bispectrum components (non-negative integer)</p></li>
<li><p>R_1, R_2,… = list of cutoff radii, one for each type (distance units)</p></li>
<li><p>w_1, w_2,… = list of neighbor weights, one for each type</p></li>
<li><p>nx, ny, nz = number of grid points in x, y, and z directions (positive integer)</p></li>
<li><p>zero or more keyword/value pairs may be appended</p></li>
<li><p>keyword = <em>rmin0</em> or <em>switchflag</em> or <em>bzeroflag</em> or <em>quadraticflag</em> or <em>chem</em> or <em>bnormflag</em> or <em>wselfallflag</em> or <em>bikflag</em> or <em>switchinnerflag</em> or <em>sinner</em> or <em>dinner</em> or <em>dgradflag</em></p>
<pre class="literal-block"><em>rmin0</em> value = parameter in distance to angle conversion (distance units)
<em>switchflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = do not use switching function
   <em>1</em> = use switching function
<em>bzeroflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = do not subtract B0
   <em>1</em> = subtract B0
<em>quadraticflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = do not generate quadratic terms
   <em>1</em> = generate quadratic terms
<em>chem</em> values = <em>nelements</em> <em>elementlist</em>
   <em>nelements</em> = number of SNAP elements
   <em>elementlist</em> = <em>ntypes</em> integers in range [0, <em>nelements</em>)
<em>bnormflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = do not normalize
   <em>1</em> = normalize bispectrum components
<em>wselfallflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = self-contribution only for element of central atom
   <em>1</em> = self-contribution for all elements
<em>switchinnerflag</em> value = <em>0</em> or <em>1</em>
   <em>0</em> = do not use inner switching function
   <em>1</em> = use inner switching function
<em>sinner</em> values = <em>sinnerlist</em>
   <em>sinnerlist</em> = <em>ntypes</em> values of <em>Sinner</em> (distance units)
<em>dinner</em> values = <em>dinnerlist</em>
   <em>dinnerlist</em> = <em>ntypes</em> values of <em>Dinner</em> (distance units)
<em>bikflag</em> value = <em>0</em> or <em>1</em> (only implemented for compute snap)
   <em>0</em> = descriptors are summed over atoms of each type
   <em>1</em> = descriptors are listed separately for each atom
<em>dgradflag</em> value = <em>0</em> or <em>1</em> (only implemented for compute snap)
   <em>0</em> = descriptor gradients are summed over atoms of each type
   <em>1</em> = descriptor gradients are listed separately for each atom pair</pre>
</li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">compute </span><span class="nv nv-Identifier">b</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">sna</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">0.99363</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="m">2.4</span><span class="w"> </span><span class="m">0.75</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">rmin0</span><span class="w"> </span><span class="m">0.0</span>
<span class="k">compute </span><span class="nv nv-Identifier">db</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">sna</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">0.95</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">compute </span><span class="nv nv-Identifier">vb</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">sna</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">0.95</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">compute </span><span class="nv nv-Identifier">snap</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">snap</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">0.95</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">compute </span><span class="nv nv-Identifier">snap</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">snap</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.99363</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">3.81</span><span class="w"> </span><span class="m">3.83</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.93</span><span class="w"> </span><span class="n">chem</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
<span class="k">compute </span><span class="nv nv-Identifier">snap</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">snap</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.99363</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">3.81</span><span class="w"> </span><span class="m">3.83</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.93</span><span class="w"> </span><span class="n">switchinnerflag</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">sinner</span><span class="w"> </span><span class="m">1.35</span><span class="w"> </span><span class="m">1.6</span><span class="w"> </span><span class="n">dinner</span><span class="w"> </span><span class="m">0.25</span><span class="w"> </span><span class="m">0.3</span>
<span class="k">compute </span><span class="nv nv-Identifier">bgrid</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">sna</span><span class="o">/</span><span class="n">grid</span><span class="o">/</span><span class="n">local</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">1.4</span><span class="w"> </span><span class="m">0.95</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="m">1.0</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Define a computation that calculates a set of quantities related to the
bispectrum components of the atoms in a group. These computes are used
primarily for calculating the dependence of energy, force, and stress
components on the linear coefficients in the <a class="reference internal" href="pair_snap.html"><span class="doc">snap pair_style</span></a>, which is useful when training a SNAP potential to match
target data.</p>
<p>Bispectrum components of an atom are order parameters characterizing the
radial and angular distribution of neighbor atoms. The detailed
mathematical definition is given in the paper by Thompson et
al. <a class="reference internal" href="#thompson20141"><span class="std std-ref">(Thompson)</span></a></p>
<p>The position of a neighbor atom <em>i’</em> relative to a central atom <em>i</em> is a
point within the 3D ball of radius <span class="math notranslate nohighlight">\(R_{ii'}\)</span> = <em>rcutfac</em>
<span class="math notranslate nohighlight">\((R_i + R_i')\)</span></p>
<p>Bartok et al. <a class="reference internal" href="#bartok20101"><span class="std std-ref">(Bartok)</span></a>, proposed mapping this 3D
ball onto the 3-sphere, the surface of the unit ball in a
four-dimensional space.  The radial distance <em>r</em> within <em>R_ii’</em> is
mapped on to a third polar angle <span class="math notranslate nohighlight">\(\theta_0\)</span> defined by,</p>
<div class="math notranslate nohighlight">
\[\theta_0 = {\sf rfac0} \frac{r-r_{min0}}{R_{ii'}-r_{min0}} \pi\]</div>
<p>In this way, all possible neighbor positions are mapped on to a subset
of the 3-sphere.  Points south of the latitude <span class="math notranslate nohighlight">\(\theta_0\)</span> =
<em>rfac0</em> <span class="math notranslate nohighlight">\(\pi\)</span> are excluded.</p>
<p>The natural basis for functions on the 3-sphere is formed by the
representatives of <em>SU(2)</em>, the matrices <span class="math notranslate nohighlight">\(U^j_{m,m'}(\theta, \phi,
\theta_0)\)</span>.  These functions are better known as <span class="math notranslate nohighlight">\(D^j_{m,m'}\)</span>, the
elements of the Wigner <em>D</em>-matrices <a class="reference internal" href="#meremianin2006"><span class="std std-ref">(Meremianin</span></a>, <a class="reference internal" href="#varshalovich1987"><span class="std std-ref">Varshalovich</span></a>, <a class="reference internal" href="#mason2009"><span class="std std-ref">Mason)</span></a> The density of neighbors on the 3-sphere can be written as
a sum of Dirac-delta functions, one for each neighbor, weighted by
species and radial distance. Expanding this density function as a
generalized Fourier series in the basis functions, we can write each
Fourier coefficient as</p>
<div class="math notranslate nohighlight">
\[u^j_{m,m'} = U^j_{m,m'}(0,0,0) + \sum_{r_{ii'} &lt; R_{ii'}}{f_c(r_{ii'}) w_{\mu_{i'}} U^j_{m,m'}(\theta_0,\theta,\phi)}\]</div>
<p>The <span class="math notranslate nohighlight">\(w_{\mu_{i'}}\)</span> neighbor weights are dimensionless numbers that
depend on <span class="math notranslate nohighlight">\(\mu_{i'}\)</span>, the SNAP element of atom <em>i’</em>, while the
central atom is arbitrarily assigned a unit weight.  The function
<span class="math notranslate nohighlight">\(f_c(r)\)</span> ensures that the contribution of each neighbor atom goes
smoothly to zero at <span class="math notranslate nohighlight">\(R_{ii'}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_c(r)   = &amp; \frac{1}{2}(\cos(\pi \frac{r-r_{min0}}{R_{ii'}-r_{min0}}) + 1), r \leq R_{ii'} \\
         = &amp; 0,  r &gt; R_{ii'}\end{split}\]</div>
<p>The expansion coefficients <span class="math notranslate nohighlight">\(u^j_{m,m'}\)</span> are complex-valued and
they are not directly useful as descriptors, because they are not
invariant under rotation of the polar coordinate frame. However, the
following scalar triple products of expansion coefficients can be shown
to be real-valued and invariant under rotation <a class="reference internal" href="#bartok20101"><span class="std std-ref">(Bartok)</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}B_{j_1,j_2,j}  =
\sum_{m_1,m'_1=-j_1}^{j_1}\sum_{m_2,m'_2=-j_2}^{j_2}\sum_{m,m'=-j}^{j} (u^j_{m,m'})^*
H {\scriptscriptstyle \begin{array}{l} {j} {m} {m'} \\
     {j_1} {m_1} {m'_1} \\
     {j_2} {m_2} {m'_2} \end{array}}
     u^{j_1}_{m_1,m'_1} u^{j_2}_{m_2,m'_2}\end{split}\]</div>
<p>The constants <span class="math notranslate nohighlight">\(H^{jmm'}_{j_1 m_1 m_{1'},j_2 m_ 2m_{2'}}\)</span> are
coupling coefficients, analogous to Clebsch-Gordan coefficients for
rotations on the 2-sphere. These invariants are the components of the
bispectrum and these are the quantities calculated by the compute
<em>sna/atom</em>. They characterize the strength of density correlations at
three points on the 3-sphere. The j2=0 subset form the power spectrum,
which characterizes the correlations of two points. The lowest-order
components describe the coarsest features of the density function, while
higher-order components reflect finer detail. Each bispectrum component
contains terms that depend on the positions of up to 4 atoms (3
neighbors and the central atom).</p>
<p>Compute <em>snad/atom</em> calculates the derivative of the bispectrum
components summed separately for each LAMMPS atom type:</p>
<div class="math notranslate nohighlight">
\[-\sum_{i' \in I} \frac{\partial {B^{i'}_{j_1,j_2,j}  }}{\partial {\bf r}_i}\]</div>
<p>The sum is over all atoms <em>i’</em> of atom type <em>I</em>.  For each atom <em>i</em>,
this compute evaluates the above expression for each direction, each
atom type, and each bispectrum component.  See section below on output
for a detailed explanation.</p>
<p>Compute <em>snav/atom</em> calculates the virial contribution due to the
derivatives:</p>
<div class="math notranslate nohighlight">
\[-{\bf r}_i \otimes \sum_{i' \in I} \frac{\partial {B^{i'}_{j_1,j_2,j}}}{\partial {\bf r}_i}\]</div>
<p>Again, the sum is over all atoms <em>i’</em> of atom type <em>I</em>.  For each atom
<em>i</em>, this compute evaluates the above expression for each of the six
virial components, each atom type, and each bispectrum component.  See
section below on output for a detailed explanation.</p>
<p>Compute <em>snap</em> calculates a global array containing information related
to all three of the above per-atom computes <em>sna/atom</em>, <em>snad/atom</em>,
and <em>snav/atom</em>. The first row of the array contains the summation of
<em>sna/atom</em> over all atoms, but broken out by type. The last six rows of
the array contain the summation of <em>snav/atom</em> over all atoms, broken
out by type. In between these are 3*<em>N</em> rows containing the same
values computed by <em>snad/atom</em> (these are already summed over all atoms
and broken out by type). The element in the last column of each row
contains the potential energy, force, or stress, according to the row.
These quantities correspond to the user-specified reference potential
that must be subtracted from the target data when fitting SNAP.  The
potential energy calculation uses the built in compute <em>thermo_pe</em>.  The
stress calculation uses a compute called <em>snap_press</em> that is
automatically created behind the scenes, according to the following
command:</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">compute </span><span class="nv nv-Identifier">snap_press</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">virial</span>
</pre></div>
</div>
<p>See section below on output for a detailed explanation of the data
layout in the global array.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3Aug2022.</span></p>
</div>
<p>The compute <em>sna/grid</em> and <em>sna/grid/local</em> commands calculate
bispectrum components for a regular grid of points.  These are
calculated from the local density of nearby atoms <em>i’</em> around each grid
point, as if there was a central atom <em>i</em> at the grid point. This is
useful for characterizing fine-scale structure in a configuration of
atoms, and it is used in the <a class="reference external" href="https://github.com/casus/mala">MALA package</a> to build machine-learning surrogates
for finite-temperature Kohn-Sham density functional theory (<a class="reference internal" href="#ellis2021"><span class="std std-ref">Ellis
et al.</span></a>) Neighbor atoms not in the group do not contribute
to the bispectrum components of the grid points. The distance cutoff
<span class="math notranslate nohighlight">\(R_{ii'}\)</span> assumes that <em>i</em> has the same type as the neighbor atom
<em>i’</em>.</p>
<p>Compute <em>sna/grid</em> calculates a global array containing bispectrum
components for a regular grid of points.
The grid is aligned with the current box dimensions, with the
first point at the box origin, and forming a regular 3d array with
<em>nx</em>, <em>ny</em>, and <em>nz</em> points in the x, y, and z directions. For triclinic
boxes, the array is congruent with the periodic lattice vectors
a, b, and c. The array contains one row for each of the
<span class="math notranslate nohighlight">\(nx \times ny \times nz\)</span> grid points, looping over the index for <em>ix</em> fastest,
then <em>iy</em>, and <em>iz</em> slowest.  Each row of the array contains the <em>x</em>, <em>y</em>,
and <em>z</em> coordinates of the grid point, followed by the bispectrum
components. See section below on output for a detailed explanation of the data
layout in the global array.</p>
<p>Compute <em>sna/grid/local</em> calculates bispectrum components of a regular
grid of points similarly to compute <em>sna/grid</em> described above.
However, because the array is local, it contains only rows for grid points
that are local to the processor subdomain. The global grid
of <span class="math notranslate nohighlight">\(nx \times ny \times nz\)</span> points is still laid out in space the same as for <em>sna/grid</em>,
but grid points are strictly partitioned, so that every grid point appears in
one and only one local array.  The array contains one row for each of the
local grid points, looping over the global index <em>ix</em> fastest,
then <em>iy</em>, and <em>iz</em> slowest.  Each row of the array contains
the global indexes <em>ix</em>, <em>iy</em>, and <em>iz</em> first, followed by the <em>x</em>, <em>y</em>,
and <em>z</em> coordinates of the grid point, followed by the bispectrum
components. See section below on output for a detailed explanation of the data
layout in the global array.</p>
<p>The value of all bispectrum components will be zero for atoms not in
the group. Neighbor atoms not in the group do not contribute to the
bispectrum of atoms in the group.</p>
<p>The neighbor list needed to compute this quantity is constructed each
time the calculation is performed (i.e. each time a snapshot of atoms
is dumped).  Thus it can be inefficient to compute/dump this quantity
too frequently.</p>
<p>The argument <em>rcutfac</em> is a scale factor that controls the ratio of
atomic radius to radial cutoff distance.</p>
<p>The argument <em>rfac0</em> and the optional keyword <em>rmin0</em> define the
linear mapping from radial distance to polar angle <span class="math notranslate nohighlight">\(theta_0\)</span> on the
3-sphere, given above.</p>
<p>The argument <em>twojmax</em> defines which
bispectrum components are generated. See section below on output for a
detailed explanation of the number of bispectrum components and the
ordered in which they are listed.</p>
<p>The keyword <em>switchflag</em> can be used to turn off the switching
function <span class="math notranslate nohighlight">\(f_c(r)\)</span>.</p>
<p>The keyword <em>bzeroflag</em> determines whether or not <em>B0</em>, the bispectrum
components of an atom with no neighbors, are subtracted from the
calculated bispectrum components. This optional keyword normally only
affects compute <em>sna/atom</em>. However, when <em>quadraticflag</em> is on, it
also affects <em>snad/atom</em> and <em>snav/atom</em>.</p>
<p>The keyword <em>quadraticflag</em> determines whether or not the quadratic
combinations of bispectrum quantities are generated.  These are formed
by taking the outer product of the vector of bispectrum components with
itself.  See section below on output for a detailed explanation of the
number of quadratic terms and the ordered in which they are listed.</p>
<p>The keyword <em>chem</em> activates the explicit multi-element variant of the
SNAP bispectrum components. The argument <em>nelements</em> specifies the
number of SNAP elements that will be handled.  This is followed by
<em>elementlist</em>, a list of integers of length <em>ntypes</em>, with values in the
range [0, <em>nelements</em> ), which maps each LAMMPS type to one of the SNAP
elements.  Note that multiple LAMMPS types can be mapped to the same
element, and some elements may be mapped by no LAMMPS type. However, in
typical use cases (training SNAP potentials) the mapping from LAMMPS
types to elements is one-to-one.</p>
<p>The explicit multi-element variant invoked by the <em>chem</em> keyword
partitions the density of neighbors into partial densities for each
chemical element.  This is described in detail in the paper by
<a class="reference internal" href="#cusentino2020"><span class="std std-ref">Cusentino et al.</span></a> The bispectrum components are
indexed on ordered triplets of elements:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B_{j_1,j_2,j}^{\kappa\lambda\mu} =
\sum_{m_1,m'_1=-j_1}^{j_1}\sum_{m_2,m'_2=-j_2}^{j_2}\sum_{m,m'=-j}^{j} (u^{\mu}_{j,m,m'})^*
H {\scriptscriptstyle \begin{array}{l} {j} {m} {m'} \\
     {j_1} {m_1} {m'_1} \\
     {j_2} {m_2} {m'_2} \end{array}}
     u^{\kappa}_{j_1,m_1,m'_1} u^{\lambda}_{j_2,m_2,m'_2}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u^{\mu}_{j,m,m'}\)</span> is an expansion coefficient for the partial density of neighbors
of element <span class="math notranslate nohighlight">\(\mu\)</span></p>
<div class="math notranslate nohighlight">
\[u^{\mu}_{j,m,m'} =  w^{self}_{\mu_{i}\mu} U^{j,m,m'}(0,0,0) + \sum_{r_{ii'} &lt; R_{ii'}}{\delta_{\mu\mu_{i'}}f_c(r_{ii'}) w_{\mu_{i'}} U^{j,m,m'}(\theta_0,\theta,\phi)}\]</div>
<p>where <span class="math notranslate nohighlight">\(w^{self}_{\mu_{i}\mu}\)</span> is the self-contribution, which is
either 1 or 0 (see keyword <em>wselfallflag</em> below),
<span class="math notranslate nohighlight">\(\delta_{\mu\mu_{i'}}\)</span> indicates that the sum is only over
neighbor atoms of element <span class="math notranslate nohighlight">\(\mu\)</span>, and all other quantities are the
same as those appearing in the original equation for <span class="math notranslate nohighlight">\(u^j_{m,m'}\)</span>
given above.</p>
<p>The keyword <em>wselfallflag</em> defines the rule used for the
self-contribution.  If <em>wselfallflag</em> is on, then
<span class="math notranslate nohighlight">\(w^{self}_{\mu_{i}\mu}\)</span> = 1. If it is off then
<span class="math notranslate nohighlight">\(w^{self}_{\mu_{i}\mu}\)</span> = 0, except in the case of
<span class="math notranslate nohighlight">\({\mu_{i}=\mu}\)</span>, when <span class="math notranslate nohighlight">\(w^{self}_{\mu_{i}\mu}\)</span> = 1.  When the
<em>chem</em> keyword is not used, this keyword has no effect.</p>
<p>The keyword <em>bnormflag</em> determines whether or not the bispectrum
component <span class="math notranslate nohighlight">\(B_{j_1,j_2,j}\)</span> is divided by a factor of <span class="math notranslate nohighlight">\(2j+1\)</span>.
This normalization simplifies force calculations because of the
following symmetry relation</p>
<div class="math notranslate nohighlight">
\[\frac{B_{j_1,j_2,j}}{2j+1} = \frac{B_{j,j_2,j_1}}{2j_1+1} = \frac{B_{j_1,j,j_2}}{2j_2+1}\]</div>
<p>This option is typically used in conjunction with the <em>chem</em> keyword,
and LAMMPS will generate a warning if both <em>chem</em> and <em>bnormflag</em>
are not both set or not both unset.</p>
<p>The keyword <em>switchinnerflag</em> with value 1
activates an additional radial switching
function similar to <span class="math notranslate nohighlight">\(f_c(r)\)</span> above, but acting to switch off
smoothly contributions from neighbor atoms at short separation distances.
This is useful when SNAP is used in combination with a simple
repulsive potential. For a neighbor atom at
distance <span class="math notranslate nohighlight">\(r\)</span>, its contribution is scaled by a multiplicative
factor <span class="math notranslate nohighlight">\(f_{inner}(r)\)</span> defined as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}             = &amp; 0,  r \leq S_{inner} - D_{inner} \\
f_{inner}(r) = &amp; \frac{1}{2}(1 - \cos(\frac{\pi}{2} (1 + \frac{r-S_{inner}}{D_{inner}})), S_{inner} - D_{inner} &lt; r \leq S_{inner} + D_{inner} \\
             = &amp; 1,  r &gt; S_{inner} + D_{inner}\end{split}\]</div>
<p>where the switching region is centered at <span class="math notranslate nohighlight">\(S_{inner}\)</span> and it extends a distance <span class="math notranslate nohighlight">\(D_{inner}\)</span>
to the left and to the right of this.
With this option, additional keywords <em>sinner</em> and <em>dinner</em> must be used,
each followed by <em>ntypes</em>
values for <span class="math notranslate nohighlight">\(S_{inner}\)</span> and <span class="math notranslate nohighlight">\(D_{inner}\)</span>, respectively.
When the central atom and the neighbor atom have different types,
the values of <span class="math notranslate nohighlight">\(S_{inner}\)</span> and <span class="math notranslate nohighlight">\(D_{inner}\)</span> are
the arithmetic means of the values for both types.</p>
<p>The keywords <em>bikflag</em> and <em>dgradflag</em> are only used by compute <em>snap</em>.
The keyword <em>bikflag</em> determines whether or not to list the descriptors
of each atom separately, or sum them together and list in a single row.
If <em>bikflag</em> is set
to <em>0</em> then a single bispectrum row is used, which contains the per-atom bispectrum
descriptors <span class="math notranslate nohighlight">\(B_{i,k}\)</span> summed over all atoms <em>i</em> to produce
<span class="math notranslate nohighlight">\(B_k\)</span>.  If <em>bikflag</em> is set
to <em>1</em> this is replaced by a separate per-atom bispectrum row for each atom.
In this case, the entries in the final column for these rows
are set to zero.</p>
<p>The keyword <em>dgradflag</em> determines whether to sum atom gradients or list
them separately. If <em>dgradflag</em> is set to 0, the bispectrum
descriptor gradients w.r.t. atom <em>j</em> are summed over all atoms <em>i’</em>
of type <em>I</em> (similar to <em>snad/atom</em> above).
If <em>dgradflag</em> is set to 1, gradients are listed separately for each pair of atoms.
Each row corresponds
to a single term <span class="math notranslate nohighlight">\(\frac{\partial {B_{i,k}  }}{\partial {r}^a_j}\)</span>
where <span class="math notranslate nohighlight">\({r}^a_j\)</span> is the <em>a-th</em> position coordinate of the atom with global
index <em>j</em>. This also changes
the number of columns to be equal to the number of bispectrum components, with 3
additional columns representing the indices <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(a\)</span>,
as explained more in the Output info section below. The option <em>dgradflag=1</em>
requires that <em>bikflag=1</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using <em>dgradflag</em> = 1 produces a global array with <span class="math notranslate nohighlight">\(N + 3N^2 + 1\)</span> rows
which becomes expensive for systems with more than 1000 atoms.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a bonded system, then the settings of <a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> command can remove pairwise interactions between
atoms in the same bond, angle, or dihedral.  This is the default
setting for the <a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> command, and
means those pairwise interactions do not appear in the neighbor list.
Because this fix uses the neighbor list, it also means those pairs
will not be included in the calculation.  One way to get around this,
is to write a dump file, and use the <a class="reference internal" href="rerun.html"><span class="doc">rerun</span></a> command to
compute the bispectrum components for snapshots in the dump file.
The rerun script can use a <a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a>
command that includes all pairs in the neighbor list.</p>
</div>
</section>
<hr class="docutils" />
<section id="output-info">
<h2>Output info<a class="headerlink" href="#output-info" title="Permalink to this heading">¶</a></h2>
<p>Compute <em>sna/atom</em> calculates a per-atom array, each column
corresponding to a particular bispectrum component.  The total number of
columns and the identity of the bispectrum component contained in each
column depend of the value of <em>twojmax</em>, as described by the following
piece of python code:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for j1 in range(0,twojmax+1):
    for j2 in range(0,j1+1):
        for j in range(j1-j2,min(twojmax,j1+j2)+1,2):
            if (j&gt;=j1): print j1/2.,j2/2.,j/2.
</pre></div>
</div>
<p>For even twojmax = 2(<em>m</em>-1), <span class="math notranslate nohighlight">\(K = m(m+1)(2m+1)/6\)</span>, the <em>m</em>-th pyramidal number. For odd twojmax = 2 <em>m</em>-1, <span class="math notranslate nohighlight">\(K = m(m+1)(m+2)/3\)</span>, twice the <em>m</em>-th tetrahedral number.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the <em>diagonal</em> keyword allowing other possible choices
for the number of bispectrum components was removed in 2019,
since all potentials use the value of 3, corresponding to the
above set of bispectrum components.</p>
</div>
<p>Compute <em>snad/atom</em> evaluates a per-atom array. The columns are arranged
into <em>ntypes</em> blocks, listed in order of atom type <em>I</em>.  Each block
contains three sub-blocks corresponding to the <em>x</em>, <em>y</em>, and <em>z</em>
components of the atom position.  Each of these sub-blocks contains <em>K</em>
columns for the <em>K</em> bispectrum components, the same as for compute
<em>sna/atom</em></p>
<p>Compute <em>snav/atom</em> evaluates a per-atom array. The columns are arranged
into <em>ntypes</em> blocks, listed in order of atom type <em>I</em>.  Each block
contains six sub-blocks corresponding to the <em>xx</em>, <em>yy</em>, <em>zz</em>,
<em>yz</em>, <em>xz</em>, and <em>xy</em> components of the virial tensor in Voigt
notation.  Each of these sub-blocks contains <em>K</em> columns for the <em>K</em>
bispectrum components, the same as for compute <em>sna/atom</em></p>
<p>Compute <em>snap</em> evaluates a global array.  The columns are arranged into
<em>ntypes</em> blocks, listed in order of atom type <em>I</em>. Each block contains
one column for each bispectrum component, the same as for compute
<em>sna/atom</em>. A final column contains the corresponding energy, force
component on an atom, or virial stress component. The rows of the array
appear in the following order:</p>
<ul class="simple">
<li><p>1 row: <em>sna/atom</em> quantities summed for all atoms of type <em>I</em></p></li>
<li><p>3*<em>N</em> rows: <em>snad/atom</em> quantities, with derivatives w.r.t. x, y, and z coordinate of atom <em>i</em> appearing in consecutive rows. The atoms are sorted based on atom ID.</p></li>
<li><p>6 rows: <em>snav/atom</em> quantities summed for all atoms of type <em>I</em></p></li>
</ul>
<p>For example, if <em>K</em> =30 and ntypes=1, the number of columns in the
per-atom arrays generated by <em>sna/atom</em>, <em>snad/atom</em>, and
<em>snav/atom</em> are 30, 90, and 180, respectively. With <em>quadratic</em> value=1,
the numbers of columns are 930, 2790, and 5580, respectively.  The
number of columns in the global array generated by <em>snap</em> are 31, and
931, respectively, while the number of rows is 1+3*<em>N</em>+6, where <em>N</em>
is the total number of atoms.</p>
<p>Compute <em>sna/grid</em> evaluates a global array.
The array contains one row for each of the
<span class="math notranslate nohighlight">\(nx \times ny \times nz\)</span> grid points, looping over the index for <em>ix</em> fastest,
then <em>iy</em>, and <em>iz</em> slowest.  Each row of the array contains the <em>x</em>, <em>y</em>,
and <em>z</em> coordinates of the grid point, followed by the bispectrum
components.</p>
<p>Compute <em>sna/grid/local</em> evaluates a local array.
The array contains one row for each of the
local grid points, looping over the global index <em>ix</em> fastest,
then <em>iy</em>, and <em>iz</em> slowest.  Each row of the array contains
the global indexes <em>ix</em>, <em>iy</em>, and <em>iz</em> first, followed by the <em>x</em>, <em>y</em>,
and <em>z</em> coordinates of the grid point, followed by the bispectrum
components.</p>
<p>If the <em>quadratic</em> keyword value is set to 1, then additional columns
are generated, corresponding to the products of all distinct pairs of
bispectrum components. If the number of bispectrum components is <em>K</em>,
then the number of distinct pairs is <em>K</em>(<em>K</em>+1)/2.  For compute
<em>sna/atom</em> these columns are appended to existing <em>K</em> columns.  The
ordering of quadratic terms is upper-triangular, (1,1),(1,2)…(1,<em>K</em>),(2,1)…(<em>K</em>-1,<em>K</em>-1),(<em>K</em>-1,<em>K</em>),(<em>K</em>,<em>K</em>).
For computes <em>snad/atom</em> and <em>snav/atom</em> each set of <em>K</em>(<em>K</em>+1)/2
additional columns is inserted directly after each of sub-block of
linear terms i.e. linear and quadratic terms are contiguous.  So the
nesting order from inside to outside is bispectrum component, linear
then quadratic, vector/tensor component, type.</p>
<p>If the <em>chem</em> keyword is used, then the data is arranged into
<span class="math notranslate nohighlight">\(N_{elem}^3\)</span> sub-blocks, each sub-block corresponding to a
particular chemical labeling <span class="math notranslate nohighlight">\(\kappa\lambda\mu\)</span> with the last
label changing fastest.  Each sub-block contains <em>K</em> bispectrum
components. For the purposes of handling contributions to force, virial,
and quadratic combinations, these <span class="math notranslate nohighlight">\(N_{elem}^3\)</span> sub-blocks are
treated as a single block of <span class="math notranslate nohighlight">\(K N_{elem}^3\)</span> columns.</p>
<p>If the <em>bik</em> keyword is set to 1, the structure of the snap array is expanded.
The first <span class="math notranslate nohighlight">\(N\)</span> rows of the snap array
correspond to <span class="math notranslate nohighlight">\(B_{i,k}\)</span> instead of a single row summed over atoms <span class="math notranslate nohighlight">\(i\)</span>.
In this case, the entries in the final column for these rows
are set to zero. Also, each row contains only non-zero entries for the
columns corresponding to the type of that atom. This is not true in the case
of <em>dgradflag</em> keyword = 1 (see below).</p>
<p>If the <em>dgradflag</em> keyword is set to 1, this changes the structure of the
global array completely.
Here the <em>snad/atom</em> quantities are replaced with rows corresponding to
descriptor gradient components on single atoms:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial {B_{i,k}  }}{\partial {r}^a_j}\]</div>
<p>where <span class="math notranslate nohighlight">\({r}^a_j\)</span> is the <em>a-th</em> position coordinate of the atom with global
index <em>j</em>. The rows are
organized in chunks, where each chunk corresponds to an atom with global index
<span class="math notranslate nohighlight">\(j\)</span>. The rows in an atom <span class="math notranslate nohighlight">\(j\)</span> chunk correspond to
atoms with global index <span class="math notranslate nohighlight">\(i\)</span>. The total number of rows for
these descriptor gradients is therefore <span class="math notranslate nohighlight">\(3N^2\)</span>.
The number of columns is equal to the number of bispectrum components,
plus 3 additional left-most columns representing the global atom indices
<span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>,
and Cartesian direction <span class="math notranslate nohighlight">\(a\)</span>  (0, 1, 2, for x, y, z).
The first 3 columns of the first <span class="math notranslate nohighlight">\(N\)</span> rows belong to the reference
potential force components. The remaining K columns contain the
<span class="math notranslate nohighlight">\(B_{i,k}\)</span> per-atom descriptors corresponding to the non-zero entries
obtained when <em>bikflag</em> = 1.
The first column of the last row, after the first
<span class="math notranslate nohighlight">\(N + 3N^2\)</span> rows, contains the reference potential
energy. The virial components are not used with this option. The total number of
rows is therefore <span class="math notranslate nohighlight">\(N + 3N^2 + 1\)</span> and the number of columns is <span class="math notranslate nohighlight">\(K + 3\)</span>.</p>
<p>These values can be accessed by any command that uses per-atom values
from a compute as input.  See the <a class="reference internal" href="Howto_output.html"><span class="doc">Howto output</span></a> doc
page for an overview of LAMMPS output options. To see how this command
can be used within a Python workflow to train SNAP potentials, see the
examples in <a class="reference external" href="https://github.com/FitSNAP/FitSNAP">FitSNAP</a>.</p>
</section>
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>These computes are part of the ML-SNAP package.  They are only enabled
if LAMMPS was built with that package.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> page for more info.</p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="pair_snap.html"><span class="doc">pair_style snap</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>The optional keyword defaults are <em>rmin0</em> = 0,
<em>switchflag</em> = 1, <em>bzeroflag</em> = 1, <em>quadraticflag</em> = 0,
<em>bnormflag</em> = 0, <em>wselfallflag</em> = 0, <em>switchinnerflag</em> = 0,</p>
<hr class="docutils" />
<p id="thompson20141"><strong>(Thompson)</strong> Thompson, Swiler, Trott, Foiles, Tucker, J Comp Phys, 285, 316, (2015).</p>
<p id="bartok20101"><strong>(Bartok)</strong> Bartok, Payne, Risi, Csanyi, Phys Rev Lett, 104, 136403 (2010).</p>
<p id="meremianin2006"><strong>(Meremianin)</strong> Meremianin, J. Phys. A,  39, 3099 (2006).</p>
<p id="varshalovich1987"><strong>(Varshalovich)</strong> Varshalovich, Moskalev, Khersonskii, Quantum Theory
of Angular Momentum, World Scientific, Singapore (1987).</p>
<p id="mason2009"><strong>(Mason)</strong> J. K. Mason, Acta Cryst A65, 259 (2009).</p>
<p id="cusentino2020"><strong>(Cusentino)</strong> Cusentino, Wood, Thompson, J Phys Chem A, 124, 5456, (2020)</p>
<p id="ellis2021"><strong>(Ellis)</strong> Ellis, Fiedler, Popoola, Modine, Stephens, Thompson, Cangi, Rajamanickam,  Phys Rev B, 104, 035120, (2021)</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="compute_smd_vol.html" class="btn btn-neutral float-left" title="compute smd/vol command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="compute_sph_e_atom.html" class="btn btn-neutral float-right" title="compute sph/e/atom command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>