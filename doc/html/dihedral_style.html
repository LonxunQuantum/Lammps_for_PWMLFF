<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dihedral_style command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/dihedral_style.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dihedral_write command" href="dihedral_write.html" />
    <link rel="prev" title="dihedral_coeff command" href="dihedral_coeff.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dihedral_charmm.html">dihedral_style charmm command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_charmm.html#dihedral-style-charmmfsw-command">dihedral_style charmmfsw command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_class2.html">dihedral_style class2 command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_coeff.html">dihedral_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_cosine_shift_exp.html">dihedral_style cosine/shift/exp command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_fourier.html">dihedral_style fourier command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_harmonic.html">dihedral_style harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_helix.html">dihedral_style helix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_hybrid.html">dihedral_style hybrid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_lepton.html">dihedral_style lepton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_multi_harmonic.html">dihedral_style multi/harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_nharmonic.html">dihedral_style nharmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_none.html">dihedral_style none command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_opls.html">dihedral_style opls command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_quadratic.html">dihedral_style quadratic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_spherical.html">dihedral_style spherical command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">dihedral_style command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html">dihedral_style table command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html#dihedral-style-table-cut-command">dihedral_style table/cut command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_write.html">dihedral_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_zero.html">dihedral_style zero command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="commands_list.html">Commands</a></li>
      <li class="breadcrumb-item active">dihedral_style command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="dihedral_coeff.html" class="btn btn-neutral float-left" title="dihedral_coeff command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_write.html" class="btn btn-neutral float-right" title="dihedral_write command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<section id="dihedral-style-command">
<span id="index-0"></span><h1>dihedral_style command<a class="headerlink" href="#dihedral-style-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_style</span><span class="w"> </span><span class="n">style</span>
</pre></div>
</div>
<ul class="simple">
<li><p>style = <em>none</em> or <em>zero</em> or <em>hybrid</em> or <em>charmm</em> or <em>charmmfsw</em> or <em>class2</em> or <em>cosine/shift/exp</em> or <em>fourier</em> or <em>harmonic</em> or <em>helix</em> or <em>lepton</em> or <em>multi/harmonic</em> or <em>nharmonic</em> or <em>opls</em> or <em>spherical</em> or <em>table</em> or <em>table/cut</em></p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">dihedral_style</span><span class="w"> </span><span class="n">multi</span><span class="o">/</span><span class="n">harmonic</span>
<span class="k">dihedral_style</span><span class="w"> </span><span class="n">hybrid</span><span class="w"> </span><span class="n">harmonic</span><span class="w"> </span><span class="n">charmm</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>Set the formula(s) LAMMPS uses to compute dihedral interactions
between quadruplets of atoms, which remain in force for the duration
of the simulation.  The list of dihedral quadruplets is read in by a
<a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> or <a class="reference internal" href="read_restart.html"><span class="doc">read_restart</span></a> command
from a data or restart file.</p>
<p>Hybrid models where dihedrals are computed using different dihedral
potentials can be setup using the <em>hybrid</em> dihedral style.</p>
<p>The coefficients associated with a dihedral style can be specified in
a data or restart file or via the <a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a>
command.</p>
<p>All dihedral potentials store their coefficient data in binary restart
files which means dihedral_style and
<a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a> commands do not need to be
re-specified in an input script that restarts a simulation.  See the
<a class="reference internal" href="read_restart.html"><span class="doc">read_restart</span></a> command for details on how to do
this.  The one exception is that dihedral_style <em>hybrid</em> only stores
the list of sub-styles in the restart file; dihedral coefficients need
to be re-specified.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When both a dihedral and pair style is defined, the
<a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> command often needs to be used to
turn off (or weight) the pairwise interaction that would otherwise
exist between four bonded atoms.</p>
</div>
<p>In the formulas listed for each dihedral style, <em>phi</em> is the torsional
angle defined by the quadruplet of atoms.  This angle has a sign
convention as shown in this diagram:</p>
<img alt="_images/dihedral_sign.jpg" class="align-center" src="_images/dihedral_sign.jpg" />
<p>where the <span class="math notranslate nohighlight">\(I,J,K,L\)</span> ordering of the four atoms that define the dihedral
is from left to right.</p>
<p>This sign convention effects several of the dihedral styles listed
below (e.g., charmm, helix) in the sense that the energy formula
depends on the sign of phi, which may be reflected in the value of the
coefficients you specify.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When comparing the formulas and coefficients for various LAMMPS
dihedral styles with dihedral equations defined by other force fields,
note that some force field implementations divide/multiply the energy
prefactor <em>K</em> by the multiple number of torsions that contain the
<em>J</em>–<em>K</em> bond in an <em>I</em>–<em>J</em>–<em>K</em>–<em>L</em> torsion.  LAMMPS does
not do this (i.e., the listed dihedral equation applies to each individual
dihedral).  Thus, you need to define <em>K</em> appropriately via the
<a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a> command to account for this
difference if necessary.</p>
</div>
<hr class="docutils" />
<p>Here is an alphabetic list of dihedral styles defined in LAMMPS.  Click on
the style to display the formula it computes and coefficients
specified by the associated <a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a> command.</p>
<p>Click on the style to display the formula it computes, any additional
arguments specified in the dihedral_style command, and coefficients
specified by the associated <a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a>
command.</p>
<p>There are also additional accelerated pair styles included in the
LAMMPS distribution for faster performance on CPUs, GPUs, and KNLs.
The individual style names on the <a class="reference internal" href="Commands_bond.html#dihedral"><span class="std std-ref">Commands dihedral</span></a> page are
followed by one or more of (g,i,k,o,t) to indicate which accelerated styles
exist.</p>
<ul class="simple">
<li><p><a class="reference internal" href="dihedral_none.html"><span class="doc">none</span></a> - turn off dihedral interactions</p></li>
<li><p><a class="reference internal" href="dihedral_zero.html"><span class="doc">zero</span></a> - topology but no interactions</p></li>
<li><p><a class="reference internal" href="dihedral_hybrid.html"><span class="doc">hybrid</span></a> - define multiple styles of dihedral interactions</p></li>
<li><p><a class="reference internal" href="dihedral_charmm.html"><span class="doc">charmm</span></a> - CHARMM dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_charmm.html"><span class="doc">charmmfsw</span></a> - CHARMM dihedral with force switching</p></li>
<li><p><a class="reference internal" href="dihedral_class2.html"><span class="doc">class2</span></a> - COMPASS (class 2) dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_cosine_shift_exp.html"><span class="doc">cosine/shift/exp</span></a> - dihedral with exponential in spring constant</p></li>
<li><p><a class="reference internal" href="dihedral_fourier.html"><span class="doc">fourier</span></a> - dihedral with multiple cosine terms</p></li>
<li><p><a class="reference internal" href="dihedral_harmonic.html"><span class="doc">harmonic</span></a> - harmonic dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_helix.html"><span class="doc">helix</span></a> - helix dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_lepton.html"><span class="doc">lepton</span></a> - dihedral potential from evaluating a string</p></li>
<li><p><a class="reference internal" href="dihedral_multi_harmonic.html"><span class="doc">multi/harmonic</span></a> - dihedral with 5 harmonic terms</p></li>
<li><p><a class="reference internal" href="dihedral_nharmonic.html"><span class="doc">nharmonic</span></a> - same as multi-harmonic with N terms</p></li>
<li><p><a class="reference internal" href="dihedral_opls.html"><span class="doc">opls</span></a> - OPLS dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_quadratic.html"><span class="doc">quadratic</span></a> - dihedral with quadratic term in angle</p></li>
<li><p><a class="reference internal" href="dihedral_spherical.html"><span class="doc">spherical</span></a> - dihedral which includes angle terms to avoid singularities</p></li>
<li><p><a class="reference internal" href="dihedral_table.html"><span class="doc">table</span></a> - tabulated dihedral</p></li>
<li><p><a class="reference internal" href="dihedral_table.html"><span class="doc">table/cut</span></a> - tabulated dihedral with analytic cutoff</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>Dihedral styles can only be set for atom styles that allow dihedrals
to be defined.</p>
<p>Most dihedral styles are part of the MOLECULE package.  They are only
enabled if LAMMPS was built with that package.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> page for more info.  The doc pages for
individual dihedral potentials tell if it is part of a package.</p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>dihedral_style none</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dihedral_coeff.html" class="btn btn-neutral float-left" title="dihedral_coeff command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_write.html" class="btn btn-neutral float-right" title="dihedral_write command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>