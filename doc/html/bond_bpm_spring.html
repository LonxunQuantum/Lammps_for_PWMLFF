<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bond_style bpm/spring command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/bond_bpm_spring.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bond_style class2 command" href="bond_class2.html" />
    <link rel="prev" title="bond_style bpm/rotational command" href="bond_bpm_rotational.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bonds.html">Bond Styles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bond_bpm_rotational.html">bond_style bpm/rotational command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">bond_style bpm/spring command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restart-and-other-info">Restart and other info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bond_class2.html">bond_style class2 command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_coeff.html">bond_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_fene.html">bond_style fene command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_fene.html#bond-style-fene-nm-command">bond_style fene/nm command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_fene_expand.html">bond_style fene/expand command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_gaussian.html">bond_style gaussian command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_gromos.html">bond_style gromos command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_harmonic.html">bond_style harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_harmonic_shift.html">bond_style harmonic/shift command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_harmonic_shift_cut.html">bond_style harmonic/shift/cut command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_hybrid.html">bond_style hybrid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_lepton.html">bond_style lepton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_mesocnt.html">bond_style mesocnt command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_mm3.html">bond_style mm3 command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_morse.html">bond_style morse command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_none.html">bond_style none command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_nonlinear.html">bond_style nonlinear command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_oxdna.html">bond_style oxdna/fene command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_oxdna.html#bond-style-oxdna2-fene-command">bond_style oxdna2/fene command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_oxdna.html#bond-style-oxrna2-fene-command">bond_style oxrna2/fene command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_quartic.html">bond_style quartic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_special.html">bond_style special command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_style.html">bond_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_table.html">bond_style table command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_write.html">bond_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_zero.html">bond_style zero command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="bonds.html">Bond Styles</a></li>
      <li class="breadcrumb-item active">bond_style bpm/spring command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="bond_bpm_rotational.html" class="btn btn-neutral float-left" title="bond_style bpm/rotational command" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bond_class2.html" class="btn btn-neutral float-right" title="bond_style class2 command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<section id="bond-style-bpm-spring-command">
<span id="index-0"></span><h1>bond_style bpm/spring command<a class="headerlink" href="#bond-style-bpm-spring-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">bond_style</span><span class="w"> </span><span class="n">bpm</span><span class="o">/</span><span class="n">spring</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">attribute1</span><span class="w"> </span><span class="n">attribute2</span><span class="w"> </span><span class="n">...</span>
</pre></div>
</div>
<ul>
<li><p>optional keyword = <em>overlay/pair</em> or <em>store/local</em> or <em>smooth</em></p>
<pre class="literal-block"><em>store/local</em> values = fix_ID N attributes ...
   * fix_ID = ID of associated internal fix to store data
   * N = prepare data for output every this many timesteps
   * attributes = zero or more of the below attributes may be appended

     <em>id1, id2</em> = IDs of 2 atoms in the bond
     <em>time</em> = the timestep the bond broke
     <em>x, y, z</em> = the center of mass position of the 2 atoms when the bond broke (distance units)
     <em>x/ref, y/ref, z/ref</em> = the initial center of mass position of the 2 atoms (distance units)

<em>overlay/pair</em> value = none
   bonded particles will still interact with pair forces

<em>smooth</em> value = <em>yes</em> or <em>no</em>
   smooths bond forces near the breaking point</pre>
</li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">bond_style</span><span class="w"> </span><span class="n">bpm</span><span class="o">/</span><span class="n">spring</span>
<span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="m">0.1</span>

<span class="k">bond_style</span><span class="w"> </span><span class="n">bpm</span><span class="o">/</span><span class="n">spring</span><span class="w"> </span><span class="n">myfix</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">id1</span><span class="w"> </span><span class="n">id2</span>
<span class="k">dump </span><span class="nv nv-Identifier">1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.broken</span><span class="w"> </span><span class="n">f_myfix[1]</span><span class="w"> </span><span class="n">f_myfix[2]</span><span class="w"> </span><span class="n">f_myfix[3]</span>
<span class="k">dump_modify</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">write_header</span><span class="w"> </span><span class="n">no</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4May2022.</span></p>
</div>
<p>The <em>bpm/spring</em> bond style computes forces and torques based on
deviations from the initial reference state of the two atoms.  The
reference state is stored by each bond when it is first computed in
the setup of a run. Data is then preserved across run commands and is
written to <a class="reference internal" href="restart.html"><span class="doc">binary restart files</span></a> such that restarting
the system will not reset the reference state of a bond.</p>
<p>This bond style only applies central-body forces which conserve the
translational and rotational degrees of freedom of a bonded set of
particles. The force has a magnitude of</p>
<div class="math notranslate nohighlight">
\[F = k (r - r_0) w\]</div>
<p>where <span class="math notranslate nohighlight">\(k_r\)</span> is a stiffness, <span class="math notranslate nohighlight">\(r\)</span> is the current distance
and <span class="math notranslate nohighlight">\(r_0\)</span> is the initial distance between the two particles, and
<span class="math notranslate nohighlight">\(w\)</span> is an optional smoothing factor discussed below. Bonds will
break at a strain of <span class="math notranslate nohighlight">\(\epsilon_c\)</span>.  This is done by setting by
setting its type to 0 such that forces are no longer computed.</p>
<p>An additional damping force is applied to the bonded
particles.  This forces is proportional to the difference in the
normal velocity of particles using a similar construction as
dissipative particle dynamics (<a class="reference internal" href="#groot4"><span class="std std-ref">(Groot)</span></a>):</p>
<div class="math notranslate nohighlight">
\[F_D = - \gamma w (\hat{r} \bullet \vec{v})\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is the damping strength, <span class="math notranslate nohighlight">\(\hat{r}\)</span> is the
radial normal vector, and <span class="math notranslate nohighlight">\(\vec{v}\)</span> is the velocity difference
between the two particles.</p>
<p>The smoothing factor <span class="math notranslate nohighlight">\(w\)</span> can be added or removed using the
<em>smooth</em> keyword. It is constructed such that forces smoothly go
to zero, avoiding discontinuities, as bonds approach the critical strain</p>
<div class="math notranslate nohighlight">
\[w = 1.0 - \left( \frac{r - r_0}{r_0 \epsilon_c} \right)^8 .\]</div>
<p>The following coefficients must be defined for each bond type via the
<a class="reference internal" href="bond_coeff.html"><span class="doc">bond_coeff</span></a> command as in the example above, or in
the data file or restart files read by the <a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> or <a class="reference internal" href="read_restart.html"><span class="doc">read_restart</span></a> commands:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span>             (force/distance units)</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon_c\)</span>    (unit less)</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>        (force/velocity units)</p></li>
</ul>
<p>By default, pair forces are not calculated between bonded particles.
Pair forces can alternatively be overlaid on top of bond forces using
the <em>overlay/pair</em> keyword. These settings require specific
<a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> settings described in the
restrictions.  Further details can be found in the <cite>:doc: how to
&lt;Howto_BPM&gt;</cite> page on BPMs.</p>
<p>If the <em>store/local</em> keyword is used, an internal fix will track bonds that
break during the simulation. Whenever a bond breaks, data is processed
and transferred to an internal fix labeled <em>fix_ID</em>. This allows the
local data to be accessed by other LAMMPS commands. Following this optional
keyword, a list of one or more attributes is specified.  These include the
IDs of the two atoms in the bond. The other attributes for the two atoms
include the timestep during which the bond broke and the current/initial
center of mass position of the two atoms.</p>
<p>Data is continuously accumulated over intervals of <em>N</em>
timesteps. At the end of each interval, all of the saved accumulated
data is deleted to make room for new data. Individual datum may
therefore persist anywhere between <em>1</em> to <em>N</em> timesteps depending on
when they are saved. This data can be accessed using the <em>fix_ID</em> and a
<a class="reference internal" href="dump.html"><span class="doc">dump local</span></a> command. To ensure all data is output,
the dump frequency should correspond to the same interval of <em>N</em>
timesteps. A dump frequency of an integer multiple of <em>N</em> can be used
to regularly output a sample of the accumulated data.</p>
<p>Note that when unbroken bonds are dumped to a file via the
<a class="reference internal" href="dump.html"><span class="doc">dump local</span></a> command, bonds with type 0 (broken bonds)
are not included.
The <a class="reference internal" href="delete_bonds.html"><span class="doc">delete_bonds</span></a> command can also be used to
query the status of broken bonds or permanently delete them, e.g.:</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">delete_bonds</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">stats</span>
<span class="k">delete_bonds</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">remove</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="restart-and-other-info">
<h2>Restart and other info<a class="headerlink" href="#restart-and-other-info" title="Permalink to this heading">¶</a></h2>
<p>This bond style writes the reference state of each bond to
<a class="reference internal" href="restart.html"><span class="doc">binary restart files</span></a>. Loading a restart
file will properly restore bonds. However, the reference state is NOT
written to data files. Therefore reading a data file will not
restore bonds and will cause their reference states to be redefined.</p>
<p>If the <em>store/local</em> option is used, an internal fix will calculate
a local vector or local array depending on the number of input values.
The length of the vector or number of rows in the array is the number
of recorded, broken bonds.  If a single input is specified, a local
vector is produced. If two or more inputs are specified, a local array
is produced where the number of columns = the number of inputs.  The
vector or array can be accessed by any command that uses local values
from a compute as input. See the <a class="reference internal" href="Howto_output.html"><span class="doc">Howto output</span></a> page
for an overview of LAMMPS output options.</p>
<p>The vector or array will be floating point values that correspond to
the specified attribute.</p>
<p>The single() function of this bond style returns 0.0 for the energy
of a bonded interaction, since energy is not conserved in these
dissipative potentials.  The single() function also calculates an
extra bond quantity, the initial distance <span class="math notranslate nohighlight">\(r_0\)</span>. This
extra quantity can be accessed by the
<a class="reference internal" href="compute_bond_local.html"><span class="doc">compute bond/local</span></a> command as <em>b1</em>.</p>
</section>
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>This bond style is part of the BPM package.  It is only enabled if
LAMMPS was built with that package.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> page for more info.</p>
<p>By default if pair interactions are to be disabled, this bond style
requires setting</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">special_bonds</span><span class="w"> </span><span class="n">lj</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">coul</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>and <a class="reference internal" href="newton.html"><span class="doc">newton</span></a> must be set to bond off.  If the
<em>overlay/pair</em> option is used, this bond style alternatively requires
setting</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">special_bonds</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">coul</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="bond_coeff.html"><span class="doc">bond_coeff</span></a>, <a class="reference internal" href="pair_bpm_spring.html"><span class="doc">pair bpm/spring</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>The option defaults are <em>smooth</em> = <em>yes</em></p>
<hr class="docutils" />
<p id="groot4"><strong>(Groot)</strong> Groot and Warren, J Chem Phys, 107, 4423-35 (1997).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bond_bpm_rotational.html" class="btn btn-neutral float-left" title="bond_style bpm/rotational command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bond_class2.html" class="btn btn-neutral float-right" title="bond_style class2 command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>