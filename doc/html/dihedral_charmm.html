<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dihedral_style charmm command &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/dihedral_charmm.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dihedral_style class2 command" href="dihedral_class2.html" />
    <link rel="prev" title="Dihedral Styles" href="dihedrals.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="Manual.html">
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="lammps_version">Version: <b>8 Feb 2023</b></div>
              <div class="lammps_release">git info: 8Feb2023</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">dihedral_style charmm command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dihedral-style-charmmfsw-command">dihedral_style charmmfsw command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_class2.html">dihedral_style class2 command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_coeff.html">dihedral_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_cosine_shift_exp.html">dihedral_style cosine/shift/exp command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_fourier.html">dihedral_style fourier command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_harmonic.html">dihedral_style harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_helix.html">dihedral_style helix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_hybrid.html">dihedral_style hybrid command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_lepton.html">dihedral_style lepton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_multi_harmonic.html">dihedral_style multi/harmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_nharmonic.html">dihedral_style nharmonic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_none.html">dihedral_style none command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_opls.html">dihedral_style opls command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_quadratic.html">dihedral_style quadratic command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_spherical.html">dihedral_style spherical command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_style.html">dihedral_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html">dihedral_style table command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_table.html#dihedral-style-table-cut-command">dihedral_style table/cut command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_write.html">dihedral_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_zero.html">dihedral_style zero command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="dihedrals.html">Dihedral Styles</a></li>
      <li class="breadcrumb-item active">dihedral_style charmm command</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="dihedrals.html" class="btn btn-neutral float-left" title="Dihedral Styles" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_class2.html" class="btn btn-neutral float-right" title="dihedral_style class2 command" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><span class="target" id="index-2"></span><span class="target" id="index-3"></span><section id="dihedral-style-charmm-command">
<span id="index-4"></span><h1>dihedral_style charmm command<a class="headerlink" href="#dihedral-style-charmm-command" title="Permalink to this heading">¶</a></h1>
<p>Accelerator Variants: <em>charmm/intel</em>, <em>charmm/kk</em>, <em>charmm/omp</em></p>
</section>
<section id="dihedral-style-charmmfsw-command">
<h1>dihedral_style charmmfsw command<a class="headerlink" href="#dihedral-style-charmmfsw-command" title="Permalink to this heading">¶</a></h1>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_style</span><span class="w"> </span><span class="n">style</span>
</pre></div>
</div>
<ul class="simple">
<li><p>style = <em>charmm</em> or <em>charmmfsw</em></p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">dihedral_style</span><span class="w"> </span><span class="n">charmm</span>
<span class="k">dihedral_style</span><span class="w"> </span><span class="n">charmmfsw</span>
<span class="k">dihedral_coeff</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">0.2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">dihedral_coeff</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">1.8</span><span class="w"> </span><span class="m">1</span><span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">dihedral_coeff</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">3.1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">0.5</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The <em>charmm</em> and <em>charmmfsw</em> dihedral styles use the potential</p>
<div class="math notranslate nohighlight">
\[E = K [ 1 + \cos (n \phi - d) ]\]</div>
<p>See <a class="reference internal" href="#dihedral-mackerell"><span class="std std-ref">(MacKerell)</span></a> for a description of the CHARMM
force field.  This dihedral style can also be used for the AMBER force
field (see comment on weighting factors below).  See
<a class="reference internal" href="#dihedral-cornell"><span class="std std-ref">(Cornell)</span></a> for a description of the AMBER force
field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The newer <em>charmmfsw</em> style was released in March 2017.  We
recommend it be used instead of the older <em>charmm</em> style when running
a simulation with the CHARMM force field, either with long-range
Coulombics or a Coulombic cutoff, via the <a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style lj/charmmfsw/coul/long</span></a> and <a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style lj/charmmfsw/coul/charmmfsh</span></a> commands respectively.
Otherwise the older <em>charmm</em> style is fine to use.  See the discussion
below and more details on the <a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style charmm</span></a> doc
page.</p>
</div>
<p>The following coefficients must be defined for each dihedral type via the
<a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a> command as in the example above, or in
the data file or restart files read by the <a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a>
or <a class="reference internal" href="read_restart.html"><span class="doc">read_restart</span></a> commands:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K\)</span> (energy)</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> (integer &gt;= 0)</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> (integer value of degrees)</p></li>
<li><p>weighting factor (1.0, 0.5, or 0.0)</p></li>
</ul>
<p>The weighting factor is required to correct for double counting
pairwise non-bonded Lennard-Jones interactions in cyclic systems or
when using the CHARMM dihedral style with non-CHARMM force fields.
With the CHARMM dihedral style, interactions between the first and fourth
atoms in a dihedral are skipped during the normal non-bonded force
computation and instead evaluated as part of the dihedral using
special epsilon and sigma values specified with the
<a class="reference internal" href="pair_charmm.html"><span class="doc">pair_coeff</span></a> command of pair styles that contain
“lj/charmm” (e.g. <a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style lj/charmm/coul/long</span></a>)
In 6-membered rings, the same 1-4 interaction would be computed twice
(once for the clockwise 1-4 pair in dihedral 1-2-3-4 and once in the
counterclockwise dihedral 1-6-5-4) and thus the weighting factor has
to be 0.5 in this case.  In 4-membered or 5-membered rings, the 1-4
dihedral also is counted as a 1-2 or 1-3 interaction when going around
the ring in the opposite direction and thus the weighting factor is
0.0, as the 1-2 and 1-3 exclusions take precedence.</p>
<p>Note that this dihedral weighting factor is unrelated to the scaling
factor specified by the <a class="reference internal" href="special_bonds.html"><span class="doc">special bonds</span></a> command
which applies to all 1-4 interactions in the system.  For CHARMM force
fields, the special_bonds 1-4 interaction scaling factor should be set
to 0.0. Since the corresponding 1-4 non-bonded interactions are
computed with the dihedral.  This means that if any of the weighting
factors defined as dihedral coefficients (fourth coeff above) are
non-zero, then you must use a pair style with “lj/charmm” and set the
special_bonds 1-4 scaling factor to 0.0 (which is the
default). Otherwise 1-4 non-bonded interactions in dihedrals will be
computed twice.</p>
<p>For simulations using the CHARMM force field with a Coulombic cutoff,
the difference between the <em>charmm</em> and <em>charmmfsw</em> styles is in the
computation of the 1-4 non-bond interactions, though only if the
distance between the two atoms is within the switching region of the
pairwise potential defined by the corresponding CHARMM pair style,
i.e. within the outer cutoff specified for the pair style.  The
<em>charmmfsw</em> style should only be used when using the corresponding
<a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style lj/charmmfsw/coul/charmmfsw</span></a> or
<a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style lj/charmmfsw/coul/long</span></a> commands.  Use
the <em>charmm</em> style with the older <a class="reference internal" href="pair_charmm.html"><span class="doc">pair_style</span></a>
commands that have just “charmm” in their style name.  See the
discussion on the <a class="reference internal" href="pair_charmm.html"><span class="doc">CHARMM pair_style</span></a> page for
details.</p>
<p>Note that for AMBER force fields, which use pair styles with “lj/cut”,
the special_bonds 1-4 scaling factor should be set to the AMBER
defaults (1/2 and 5/6) and all the dihedral weighting factors (fourth
coeff above) must be set to 0.0. In this case, you can use any pair
style you wish, since the dihedral does not need any Lennard-Jones
parameter information and will not compute any 1-4 non-bonded
interactions.  Likewise the <em>charmm</em> or <em>charmmfsw</em> styles are
identical in this case since no 1-4 non-bonded interactions are
computed.</p>
<hr class="docutils" />
<p>Styles with a <em>gpu</em>, <em>intel</em>, <em>kk</em>, <em>omp</em>, or <em>opt</em> suffix are
functionally the same as the corresponding style without the suffix.
They have been optimized to run faster, depending on your available
hardware, as discussed on the <a class="reference internal" href="Speed_packages.html"><span class="doc">Accelerator packages</span></a>
page.  The accelerated styles take the same arguments and should
produce the same results, except for round-off and precision issues.</p>
<p>These accelerated styles are part of the GPU, INTEL, KOKKOS,
OPENMP, and OPT packages, respectively.  They are only enabled if
LAMMPS was built with those packages.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> page for more info.</p>
<p>You can specify the accelerated styles explicitly in your input script
by including their suffix, or you can use the <a class="reference internal" href="Run_options.html"><span class="doc">-suffix command-line switch</span></a> when you invoke LAMMPS, or you can use the
<a class="reference internal" href="suffix.html"><span class="doc">suffix</span></a> command in your input script.</p>
<p>See the <a class="reference internal" href="Speed_packages.html"><span class="doc">Accelerator packages</span></a> page for more
instructions on how to use the accelerated styles effectively.</p>
</section>
<hr class="docutils" />
<section id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this heading">¶</a></h2>
<p>When using run_style <a class="reference internal" href="run_style.html"><span class="doc">respa</span></a>, these dihedral styles
must be assigned to the same r-RESPA level as <em>pair</em> or <em>outer</em>.</p>
<p>When used in combination with CHARMM pair styles, the 1-4
<a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> scaling factors must be set to 0.0.
Otherwise non-bonded contributions for these 1-4 pairs will be
computed multiple times.</p>
<p>These dihedral styles can only be used if LAMMPS was built with the
MOLECULE package.  See the <a class="reference internal" href="Build_package.html"><span class="doc">Build package</span></a> doc page
for more info.</p>
</section>
<section id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="dihedral_coeff.html"><span class="doc">dihedral_coeff</span></a></p>
</section>
<section id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this heading">¶</a></h2>
<p>none</p>
<hr class="docutils" />
<p id="dihedral-cornell"><strong>(Cornell)</strong> Cornell, Cieplak, Bayly, Gould, Merz, Ferguson,
Spellmeyer, Fox, Caldwell, Kollman, JACS 117, 5179-5197 (1995).</p>
<p id="dihedral-mackerell"><strong>(MacKerell)</strong> MacKerell, Bashford, Bellott, Dunbrack, Evanseck, Field,
Fischer, Gao, Guo, Ha, et al, J Phys Chem B, 102, 3586 (1998).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dihedrals.html" class="btn btn-neutral float-left" title="Dihedral Styles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dihedral_class2.html" class="btn btn-neutral float-right" title="dihedral_style class2 command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2023 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>